

### 开启Lua脚本触发
触发脚本接口写在 **QFunction-0.lua** 文件中。触发接口跟原先脚本触发接口名一样，注意**小写**。
所有触发接口，默认提供 &lt;font color="#ff00ff" style="font-family: Fixedsys;font-size: 13;"&gt;参数1：玩家对象。&lt;/font&gt;

------------

### 聊天触发前置接口

`triggerchat`

| 参数    | 类型      | 空   | 默认 | 注释                                                                                                                                                                                  |
| :------ | :-------- | :--- | :--- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| self    | `object`  | 否   |      | 玩家对象                                                                                                                                                                              |
| sMsg    | `string`  | 否   |      | 说话内容                                                                                                                                                                              |
| chat    | `integer` | 否   |      | 聊天频道<br />1:系统<br />2:喊话<br />3:私聊<br />4:行会<br />5:组队<br />6:附近<br />7:世界<br />8:国家<br />9:联盟<br />40:行会通知                                                                     |
| msgType | `string`  | 否   |      | 消息类型<br />1:普通消息<br />2:坐标<br />3:装备<br />5:系统通知消息,需使用特定富文本解析<br />6:系统通知消息,需使用FColor特定富文本解析<br />7:系统通知消息,需使用SRText特定富文本解析<br />8:猜拳 |
| result  | `bool`    | 否   |      | 是否终止说话                                                                                                                                                                          |

```lua
function triggerchat(self, sMsg, chat,msgType)
    if tonumber(sMsg) ~= nil then
        say(self, "不允许说数字。".."频道："..chat,"类型:"..msgType)
        return false
    end
    return true
end

```

### 收到私聊信息触发

`privatechat`

| 参数   | 类型      | 空   | 默认 | 注释         |
| :----- | :-------- | :--- | :--- | :----------- |
| self   | `object`  | 否   |      | 玩家对象     |
| sMsg   | `string`  | 否   |      | 说话内容     |
| chat   | `integer` | 否   |      | 聊天频道     |
| result | `bool`    | 否   |      | 是否接收私信 |
------------

### 装备相关

#### 角色穿戴/脱下装备前触发

`takeonbeforeex`~`takeoffbeforeex`

| 参数      | 类型      | 空   | 默认                | 注释                                |
| :-------- | :-------- | :--- | :------------------ | :---------------------------------- |
| self      | `object`  | 否   |                     | 玩家对象                            |
| item      | `object`  | 否   |                     | 物品对象                            |
| where     | `integer` | 否   | 引擎64_23.10.24新增 | 装备位置                            |
| makeIndex | `integer` | 否   | 引擎64_23.10.24新增 | 装备唯一ID                          |
| result    | `bool`    | 否   |                     | true = 允许操作<br />false = 阻止操作 |

`takeonbefore(X)`~`takeoffbefore(X)`

&gt; X=装备位置

| 参数   | 类型     | 空   | 默认 | 注释                                |
| :----- | :------- | :--- | :--- | :---------------------------------- |
| self   | `object` | 否   |      | 玩家对象                            |
| item   | `object` | 否   |      | 物品对象                            |
| result | `bool`   | 否   |      | true = 允许操作<br />false = 阻止操作 |

#### 角色穿戴/脱下装备后触发

`takeonex`~`takeoffex`

| 参数      | 类型      | 空   | 默认 | 注释      |
| :-------- | :-------- | :--- | :--- | :-------- |
| self      | `object`  | 否   |      | 玩家对象  |
| item      | `object`  | 否   |      | 物品对象  |
| where     | `integer` | 否   |      | 穿/脱位置 |
| itemName  | `string`  | 否   |      | 物品名    |
| makeindex | `integer` | 否   |      | 唯一ID    |

`takeon(X)`~`takeoff(X)`

&gt; X=装备位置

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| self | `object` | 否   |      | 玩家对象 |
| item | `object` | 否   |      | 物品对象 |

#### 英雄角色穿戴/脱下装备前触发

`herotakeonbeforeex`~`herotakeoffbeforeex`

| 参数      | 类型      | 空   | 默认                | 注释                                |
| :-------- | :-------- | :--- | :------------------ | :---------------------------------- |
| self      | `object`  | 否   |                     | 玩家对象                            |
| item      | `object`  | 否   |                     | 物品对象                            |
| where     | `integer` | 否   | 引擎64_24.08.07新增 | 装备位置                            |
| makeIndex | `integer` | 否   | 引擎64_24.08.07新增 | 装备唯一ID                          |
| makeIndex | `integer` | 否   | 引擎64_24.08.07新增 | 英雄对象                            |
| result    | `bool`    | 否   |                     | true = 允许操作<br />false = 阻止操作 |

#### 英雄穿戴/脱下装备回调

`herotakeonex` ~ `herotakeoffex`

| 参数      | 类型      | 空   | 默认                | 注释      |
| :-------- | :-------- | :--- | :------------------ | :-------- |
| play      | `object`  | 否   |                     | 玩家对象  |
| item      | `object`  | 否   |                     | 物品对象  |
| where     | `integer` | 否   |                     | 穿/脱位置 |
| itemName  | `string`  | 否   |                     | 物品名    |
| makeindex | `integer` | 否   |                     | 唯一ID    |
| hero      | `object`  | 否   | 引擎64_23.08.30新增 | 英雄对象  |

#### 人物死亡装备掉落前触发

`checkdropuseitems`

| 参数    | 类型      | 空   | 默认 | 注释                                |
| :------ | :-------- | :--- | :--- | :---------------------------------- |
| actor   | `object`  | 否   |      | 玩家对象                            |
| where   | `integer` | 否   |      | 装备位                              |
| itemIdx | `integer` | 否   |      | 装备idx                             |
| result  | `bool`    | 否   |      | true = 允许掉落<br />false = 阻止掉落 |

### 参照装备投保已投保装备掉落触发

`dropuseitems(X)`

&gt; X=装备位置

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| item  | `object` | 否   | 引擎64_23.10.24新增 | 装备对象 |

#### 角色装备过期触发

`itemexpired`

&gt; 称号到期时不会传入物品对象,称号名称通过常量 `&lt;$ExpiredItemName&gt;` 获取

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| item  | `object` | 否   | 引擎64_23.08.30新增 | 物品对象 |
| name  | `string` | 否   | 引擎64_23.08.30新增 | 物品名字 |

#### 英雄装备过期触发

`heroitemexpired`

&gt; 称号到期时不会传入物品对象,称号名称通过常量 `&lt;$H.ExpiredItemName&gt;` 获取

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| item  | `object` | 否   | 引擎64_23.08.30新增 | 物品对象 |
| name  | `string` | 否   | 引擎64_23.08.30新增 | 物品名字 |
| hero  | `object` | 否   | 引擎64_23.08.30新增 | 英雄对象 |

#### 角色脱下装备进入背包前触发

`takeoffexchange`

| 参数      | 类型     | 空   | 默认                | 注释       |
| :-------- | :------- | :--- | :------------------ | :--------- |
| play      | `object` | 否   |                     | 玩家对象   |
| item      | `object` | 否   | 引擎64_23.08.30新增 | 装备对象   |
| where     | `string` | 否   | 引擎64_23.08.30新增 | 装备位置   |
| makeindex | `bool`   | 否   | 引擎64_23.08.30新增 | 装备唯一id |

#### 英雄脱下装备进入背包前触发

`herotakeoffexchange`

| 参数      | 类型     | 空   | 默认                | 注释       |
| :-------- | :------- | :--- | :------------------ | :--------- |
| play      | `object` | 否   |                     | 玩家对象   |
| item      | `object` | 否   | 引擎64_23.08.30新增 | 装备对象   |
| where     | `string` | 否   | 引擎64_23.08.30新增 | 装备位置   |
| makeindex | `bool`   | 否   | 引擎64_23.08.30新增 | 装备唯一id |
| hero      | `object` | 否   | 引擎64_23.08.30新增 | 英雄对象   |

### 装备持久消失触发

`itemdamage(X)`

&gt; X=装备位置

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| item  | `object` | 否   | 引擎64_23.10.24新增 | 装备对象 |

### 武器加诅咒前触发

`makeweaponunluck`

| 参数   | 类型     | 空   | 默认 | 注释                            |
| :----- | :------- | :--- | :--- | :------------------------------ |
| actor  | `object` | 否   |      | 玩家对象                        |
| item   | `object` | 否   |      | 装备对象                        |
| result | `bool`   | 否   |      | true = 诅咒<br />false = 阻止诅咒 |

### 镶嵌宝石触发

`bagusestoneitemok`

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| item  | `object` | 否   | 引擎64_23.10.24新增 | 装备对象 |

### 卸下宝石触发

`removestoneitem`

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| item  | `object` | 否   | 引擎64_23.10.24新增 | 装备对象 |

------------

### 双击类道具触发

`stdmodefunc(X)`

&gt; X=道具表第5列(Anicount),支持道具表stdmode[2、31、200]类

| 参数   | 类型     | 空   | 默认 | 注释         |
| :----- | :------- | :--- | :--- | :----------- |
| self   | `object` | 否   |      | 玩家对象     |
| item   | `object` | 否   |      | 物品对象     |
| result | `bool`   | 否   |      | 是否允许使用 |

```lua
function stdmodefunc100(actor, itemobj)
    if getbaseinfo(actor,6) &lt; 50 then
        say(actor,"50级后才可使用")
        return false
    end
end

```

#### 双击使用道具前触发

`beforeeatitem`

&gt; 注:引擎24.0118 补全参数2 - 物品对象

| 参数          | 类型      | 空   | 默认 | 注释                                |
| :------------ | :-------- | :--- | :--- | :---------------------------------- |
| actor         | `string`  | 否   |      | 玩家对象                            |
| itemobj       | `string`  | 否   |      | 道具对象                            |
| itemidx       | `integer` | 否   |      | 道具idx                             |
| itemMakeIndex | `integer` | 否   |      | 道具唯一id                          |
| itemNum       | `integer` | 否   |      | 道具数量                            |
| stdMode       | `integer` | 否   |      | 物品表stdMode参数                   |
| result        | `boolean` | 否   |      | 返回值<br />true=允许<br />false=不允许 |

### 货币改变触发

`moneychange(X)`

&gt; X=货币道具表idx

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

```lua
for moneyIdx = 1, 100 do
    _G["moneychange"..moneyIdx] = function (actor)
        local formernum = getconst(actor, "&lt;$OLDMONEY&gt;")
        local curnum = querymoney(actor, moneyIdx)
        local name = getstditeminfo(moneyIdx, 1)
        release_print("货币【"..name.."】改变：", moneyIdx, curnum, formernum)
    end
end

```

### 物品进包前触发

&gt; 无返回值,不能阻止进包操作

`addbagbefore`

| 参数          | 类型      | 空   | 默认 | 注释        |
| :------------ | :-------- | :--- | :--- | :---------- |
| self          | `object`  | 否   |      | 玩家对象    |
| item          | `object`  | 否   |      | 物品对象    |
| itemidx       | `integer` | 否   |      | 道具idx     |
| itemMakeIndex | `integer` | 否   |      | 道具唯一idx |

### 添加背包触发

`addbag`

&gt; 接口为异步，物品进入背包时可能与原有物品堆叠起来了

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| self | `object` | 否   |      | 玩家对象 |
| item | `object` | 否   |      | 物品对象 |

### 角色扔掉丢弃金币前触发

`dropgoldfront`

| 参数    | 类型      | 空   | 默认 | 注释                                            |
| :------ | :-------- | :--- | :--- | :---------------------------------------------- |
| play    | `object`  | 否   |      | 玩家对象                                        |
| goldNum | `integer` | 否   |      | 金币数量                                        |
| result  | `bool`    | 否   |      | 是否允许丢弃<br />true=允许丢弃<br />false=不允许丢弃 |

### 角色扔掉任意物品前触发

`dropitemfrontex`

| 参数     | 类型      | 空   | 默认                | 注释                                            |
| :------- | :-------- | :--- | :------------------ | :---------------------------------------------- |
| play     | `object`  | 否   |                     | 玩家对象                                        |
| dropItem | `object`  | 否   | 引擎64_23.08.30新增 | 掉落物品                                        |
| itemName | `string`  | 否   | 引擎64_23.08.30新增 | 物品名称                                        |
| model    | `integer` | 否   | 引擎64_23.08.30新增 | 行为id<br />0=扔掉触发<br />1=人物掉落触发          |
| result   | `bool`    | 否   |                     | 是否允许丢弃<br />true=允许丢弃<br />false=不允许丢弃 |

### 扔掉任意物品后触发

`dropitemex`

| 参数     | 类型     | 空   | 默认                | 注释     |
| :------- | :------- | :--- | :------------------ | :------- |
| play     | `object` | 否   |                     | 玩家对象 |
| dropItem | `object` | 否   | 引擎64_23.08.30新增 | 掉落物品 |
| itemName | `string` | 否   | 引擎64_23.08.30新增 | 物品名称 |

### 角色爆出物品前触发

`itemdropfrombagbefore`

| 参数     | 类型     | 空   | 默认 | 注释                                                |
| :------- | :------- | :--- | :--- | :-------------------------------------------------- |
| play     | `object` | 否   |      | 玩家对象                                            |
| dropItem | `object` | 否   |      | 掉落物品                                            |
| result   | `bool`   | 否   |      | 是否允许掉落<br />true=允许掉落<br />false=不允许掉落 |

### 角色扔掉物品前触发

`itemthrowfrombagbefore`

| 参数     | 类型     | 空   | 默认 | 注释                                          |
| :------- | :------- | :--- | :--- | :-------------------------------------------- |
| play     | `object` | 否   |      | 玩家对象                                      |
| dropItem | `object` | 否   |      | 掉落物品                                      |
| result   | `bool`   | 否   |      | 是否允许扔<br />true=允许扔<br />false=不允许扔 |

### 英雄爆出物品前触发

`heroitemdropfrombagbefore`

| 参数     | 类型     | 空   | 默认 | 注释                                                |
| :------- | :------- | :--- | :--- | :-------------------------------------------------- |
| play     | `object` | 否   |      | 玩家对象                                            |
| dropItem | `object` | 否   |      | 掉落物品                                            |
| result   | `bool`   | 否   |      | 是否允许掉落<br />true=允许掉落<br />false=不允许掉落 |

### 英雄扔掉物品前触发

`heroitemthrowfrombagbefore`

| 参数     | 类型     | 空   | 默认 | 注释                                          |
| :------- | :------- | :--- | :--- | :-------------------------------------------- |
| play     | `object` | 否   |      | 玩家对象                                      |
| dropItem | `object` | 否   |      | 掉落物品                                      |
| result   | `bool`   | 否   |      | 是否允许扔<br />true=允许扔<br />false=不允许扔 |

------------

### 添加英雄背包触发

`addherobag`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| self | `object` | 否   |      | 玩家对象 |
| item | `object` | 否   |      | 物品对象 |
| hero | `object` | 否   |      | 英雄对象 |

### 英雄扔掉物品前/后触发

`herodropitemfrontex`~`herodropitemex`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
| item  | `object` | 否   |      | 物品对象 |

### 英雄扔掉物品前/后触发

`herodropitemfront(X)` ~ `herodropitem(X)`

&gt; X=物品Idx

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| item  | `object` | 否   |                     | 物品对象 |
| hero  | `object` | 否   | 引擎64_23.08.30新增 | 英雄对象 |

------------

### 受击触发

#### 暴击触发

`crittrigger` 支持物理攻击、魔法攻击 暴击触发

| 参数    | 类型      | 空   | 默认 | 注释                 |
| :------ | :-------- | :--- | :--- | :------------------- |
| self    | `object`  | 否   |      | 玩家对象             |
| attack  | `object`  | 否   |      | 受击对象             |
| damage  | `integer` | 否   |      | 暴击后伤害值         |
| MagicId | `integer` | 否   |      | 技能ID               |
| result  | `integer` | 否   |      | 返回值，修改后的伤害 |

##### 伤害反弹触发

`reboundhurt`

| 参数    | 类型     | 空   | 默认 | 注释             |
| :------ | :------- | :--- | :--- | :--------------- |
| actor   | `object` | 否   |      | 玩家对象         |
| Hiter   | `object` | 否   |      | 伤害来源对象     |
| Damage  | `number` | 否   |      | 伤害值           |
| MagicId | `number` | 否   |      | 技能ID           |
| result  | `number` | 否   |      | 返回值<br />伤害值 |

#### 攻击前

##### 人物攻击前触发

`attackdamage` 

&gt; 参数6`Model`=3(切割) 新增于引擎64_23.12.07,触发需勾选m2的参数`选项-物品参数-新增属性-启用切割`

| 参数    | 类型      | 空   | 默认                | 注释                                                 |
| :------ | :-------- | :--- | :------------------ | :--------------------------------------------------- |
| self    | `object`  | 否   |                     | 玩家对象                                             |
| Target  | `object`  | 否   |                     | 受击对象                                             |
| Hiter   | `object`  | 否   |                     | 攻击对象                                             |
| MagicId | `integer` | 否   |                     | 技能ID                                               |
| Damage  | `integer` | 否   |                     | 伤害                                                 |
| Model   | `integer` | 否   | 引擎64_23.10.24新增 | 当前攻击模式<br />0=正常<br />1=暴击<br />2=格挡<br />3=切割 |
| result  | `integer` | 否   |                     | 返回值，修改后的伤害                                 |

`attackdamagebb` 宝宝攻击前触发
`heroattackdamage` 英雄攻击前触发
`heroattackdamagebb` 英雄宝宝攻击前触发

| 参数    | 类型      | 空   | 默认 | 注释                 |
| :------ | :-------- | :--- | :--- | :------------------- |
| self    | `object`  | 否   |      | 玩家对象             |
| Target  | `object`  | 否   |      | 受击对象             |
| Hiter   | `object`  | 否   |      | 攻击对象             |
| MagicId | `integer` | 否   |      | 技能ID               |
| Damage  | `integer` | 否   |      | 伤害                 |
| result  | `integer` | 否   |      | 返回值，修改后的伤害 |

#### 攻击后

`attack` 玩家物理攻击
`magicattack` 玩家魔法攻击
`attackpet` 宝宝物理攻击
`magicattackpet` 宝宝魔法攻击
`heroattack` 英雄物理攻击
`heromagicattack` 英雄魔法攻击
`heroattackpet` 英雄宝宝物理攻击
`heromagicattackpet` 英雄宝宝魔法攻击

| 参数    | 类型      | 空   | 默认 | 注释     |
| :------ | :-------- | :--- | :--- | :------- |
| self    | `object`  | 否   |      | 玩家对象 |
| Target  | `object`  | 否   |      | 受击对象 |
| Hiter   | `object`  | 否   |      | 攻击对象 |
| MagicId | `integer` | 否   |      | 技能ID   |
------------

### 受击触发

#### 受击前

`struckdamage` 玩家受击
`struckdamagebb` 宝宝受击
`herostruckdamage` 英雄受击
`herostruckdamagebb` 英雄宝宝受击

| 参数    | 类型      | 空   | 默认 | 注释                 |
| :------ | :-------- | :--- | :--- | :------------------- |
| self    | `object`  | 否   |      | 玩家对象             |
| Hiter   | `object`  | 否   |      | 攻击对象             |
| Target  | `object`  | 否   |      | 受击对象             |
| MagicId | `integer` | 否   |      | 技能ID               |
| Damage  | `integer` | 否   |      | 伤害                 |
| result  | `integer` | 否   |      | 返回值，修改后的伤害 |

#### 受击后

`struck` 玩家物理受击
`magicstruck` 玩家魔法受击
`struckpet` 宝宝物理受击
`magicstruckpet` 宝宝魔法受击
`herostruck` 英雄物理受击
`heromagicstruck` 英雄魔法受击
`heromagicstruckpet` 英雄宝宝魔法受击
`herostruckpet` 英雄宝宝物理受击

| 参数    | 类型      | 空   | 默认 | 注释     |
| :------ | :-------- | :--- | :--- | :------- |
| self    | `object`  | 否   |      | 玩家对象 |
| Hiter   | `object`  | 否   |      | 攻击对象 |
| Target  | `object`  | 否   |      | 受击对象 |
| MagicId | `integer` | 否   |      | 技能ID   |

------------

### 使用技能触发

#### 自身使用技能触发

`magselffunc(X)`   

&gt; X=触发技能ID

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| self | `object` | 否   |      | 玩家对象 |

#### 对目标人物使用技能时自身触发

`magtagfunc(X)` 

&gt; X=触发技能ID

| 参数       | 类型     | 空   | 默认                | 注释         |
| :--------- | :------- | :--- | :------------------ | :----------- |
| self       | `object` | 否   |                     | 玩家对象     |
| roleObject | `object` | 否   | 引擎64_23.06.28新增 | 受击玩家对象 |

#### 对目标怪物使用技能时自身触发

`magmonfunc(X)` 

&gt; X=触发技能ID

| 参数      | 类型     | 空   | 默认                | 注释         |
| :-------- | :------- | :--- | :------------------ | :----------- |
| self      | `object` | 否   |                     | 玩家对象     |
| monObject | `object` | 否   | 引擎64_23.06.28新增 | 受击怪物对象 |

#### 自身使用任意技能前触发

`beginmagic`玩家触发
`herobeginmagic`英雄触发

&gt; &lt;font color="#ff0000"&gt;magselffunc(X)触发优先级在beginmagic前,阻止释放并不会影响触发magselffunc(X)&lt;/font&gt;

| 参数         | 类型      | 空   | 默认 | 注释                                          |
| :----------- | :-------- | :--- | :--- | :-------------------------------------------- |
| self         | `object`  | 否   |      | 玩家对象                                      |
| maigicID     | `integer` | 否   |      | 技能id                                        |
| maigicName   | `string`  | 否   |      | 技能名字                                      |
| targetObject | `object`  | 否   |      | 受击对象                                      |
| x            | `integer` | 否   |      | 受击对象X坐标                                 |
| y            | `integer` | 否   |      | 受击对象Y坐标                                 |
| result       | `bool`    | 否   |      | 返回值<br />true/nil=允许施法<br />false=阻止施法 |

#### 推动技能(野蛮冲撞/抗拒火环/气波功/自定义推动技能)施法前触发

`canpush`玩家触发
`herocanpush`英雄触发
`petcanpush`宠物触发
`bbcanpush`宝宝触发
`herobbcanpush`英雄宝宝触发

| 参数    | 类型      | 空   | 默认 | 注释                                                                     |
| :------ | :-------- | :--- | :--- | :----------------------------------------------------------------------- |
| self    | `object`  | 否   |      | 玩家对象                                                                 |
| Target  | `object`  | 否   |      | 受击对象                                                                 |
| Hiter   | `object`  | 否   |      | 攻击对象                                                                 |
| MagicId | `integer` | 否   |      | 技能ID                                                                   |
| result  | `bool`    | 否   |      | 返回值<br />0=不执行推动<br />1=执行推动<br />2=根据M2上的推动条件判断是否执行 |

#### 自定义技能处理伤害前触发

`custommagicdamage(X)`

| 参数   | 类型     | 空   | 默认 | 注释                                                                                                         |
| :----- | :------- | :--- | :--- | :----------------------------------------------------------------------------------------------------------- |
| Hiter  | `object` | 否   |      | 施法对象                                                                                                     |
| Target | `object` | 否   |      | 受击对象                                                                                                     |
| result | `bool`   | 否   |      | 返回值<br />true=正常施法<br />false=阻止施法(将不走后续伤害触发)<br />可用于群攻类技能,阻止部分受击对象的伤害流程 |

------------

### 任意地图杀死怪物触发

`killmon`

| 参数       | 类型      | 空   | 默认                | 注释                                                                  |
| :--------- | :-------- | :--- | :------------------ | :-------------------------------------------------------------------- |
| self       | `object`  | 否   |                     | 攻击者对象                                                            |
| mon        | `object`  | 否   |                     | 怪物对象                                                              |
| killerType | `integer` | 否   |                     | 凶手类型<br />0=凶手是宝宝;<br />1=英雄;<br />2=人物;<br />4=全局触发(无归属) |
| mon        | `string`  | 否   |                     | 对象唯一ID                                                            |
| monName    | `string`  | 否   |                     | 怪物名字                                                              |
| mapID      | `string`  | 否   | 引擎64_24.08.07新增 | 当前地图编号                                                          |

### 怪物/宝宝 死亡触发

`selfkillslave` 宝宝死亡触发，触发对象 主人
`killslave` 杀掉宝宝触发，触发对象 攻击者
`onkillmob`   杀怪触发，触发对象 攻击者 (需要在mapinfo地图参数增加onkillmon)

| 参数 | 类型     | 空   | 默认 | 注释          |
| :--- | :------- | :--- | :--- | :------------ |
| self | `object` | 否   |      | 触发对象      |
| mon  | `object` | 否   |      | 宝宝/怪物对象 |
------------

### 玩家死亡触发

`killplay`  杀人触发，触发对象：攻击者

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| self | `object` | 否   |      | 触发对象 |
| play | `object` | 否   |      | 被杀玩家 |

`herodie`   英雄被杀，触发对象：被杀英雄玩家
`playdie`   玩家被杀，触发对象：被杀玩家

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| self  | `object` | 否   |      | 被杀玩家 |
| hiter | `object` | 否   |      | 攻击者   |

------------

### 怪物物品掉落回调接口

&gt; 触发接口为自己爆率设置，只提供常用参数

| 参数         | 类型     | 空   | 默认 | 注释                               |
| :----------- | :------- | :--- | :--- | :--------------------------------- |
| self         | `object` | 否   |      | 玩家对象                           |
| DropItemName | `string` | 否   |      | 掉落物品名字                       |
| mon          | `object` | 否   |      | 掉落怪物                           |
| result       | `bool`   | 否   |      | 是否掉落,true=允许掉落，false=不允许 |

------------

### 怪物掉落物品触发

`mondropitemex` 怪物掉落统一触发

| 参数     | 类型      | 空   | 默认 | 注释                               |
| :------- | :-------- | :--- | :--- | :--------------------------------- |
| self     | `object`  | 否   |      | 玩家对象                           |
| DropItem | `object`  | 否   |      | 掉落物品                           |
| mon      | `object`  | 否   |      | 掉落怪物                           |
| nX       | `integer` | 否   |      | 掉落坐标x                          |
| nY       | `integer` | 否   |      | 掉落坐标y                          |
| result   | `bool`    | 否   |      | 是否掉落,true=允许掉落，false=不允许 |

### 杀死怪物或人物，爆物品触发

`scatterbagitems`

| 参数     | 类型     | 空   | 默认 | 注释       |
| :------- | :------- | :--- | :--- | :--------- |
| self     | `object` | 否   |      | 玩家对象   |
| dropRole | `object` | 否   |      | 掉落者对象 |
------------

### 充值触发

`recharge`

&gt; 充值时玩家不在线,则会在下次登陆时触发

| 参数           | 类型      | 空   | 默认                | 注释                             |
| :------------- | :-------- | :--- | :------------------ | :------------------------------- |
| self           | `object`  | 否   |                     | 玩家对象                         |
| Gold           | `integer` | 否   |                     | 充值金额                         |
| ProductId      | `integer` | 否   |                     | 产品ID（来源客户端充值面板调用） |
| MoneyId        | `integer` | 否   |                     | 货币ID                           |
| isReal         | `integer` | 否   |                     | =1真实充值<br />=0扶持充值         |
| orderTime      | `integer` | 否   | 引擎64_24.03.14新增 | 订单时间(时间戳)                 |
| rechargeAmount | `integer` | 否   | 引擎64_24.03.14新增 | 实际到账货币金额                 |
| giftAmount     | `integer` | 否   | 引擎64_24.03.14新增 | 额外赠送金额<br />运营后台配置     |
| refundAmount   | `integer` | 否   | 引擎64_24.03.14新增 | 开启积分金额<br />运营后台配置     |

------------

### NPC点击触发

`clicknpc`

| 参数   | 类型      | 空   | 默认 | 注释                                 |
| :----- | :-------- | :--- | :--- | :----------------------------------- |
| actor  | `object`  | 否   |      | 玩家对象                             |
| npcID  | `integer` | 否   |      | NPC索引（NPC配置表中的ID）           |
| npcName  | `string` | 否   |      | NPC名称                           |
| result | `bool`    | 否   |      | false允许继续执行Txt脚本，true不允许 |
------------

### 玩家跳转地图触发

`entermap`

| 参数  | 类型      | 空   | 默认                | 注释       |
| :---- | :-------- | :--- | :------------------ | :--------- |
| actor | `object`  | 否   |                     | 玩家对象   |
| mapid | `string`  | 否   | 引擎64_24.05.23新增 | 进入地图id |
| x     | `integer` | 否   | 引擎64_24.05.23新增 | 进入地图X  |
| y     | `integer` | 否   | 引擎64_24.05.23新增 | 进入地图Y  |

### 玩家离开地图触发

`leavemap`

| 参数  | 类型      | 空   | 默认                | 注释       |
| :---- | :-------- | :--- | :------------------ | :--------- |
| actor | `object`  | 否   |                     | 玩家对象   |
| mapid | `string`  | 否   | 引擎64_24.05.23新增 | 离开地图id |
| x     | `integer` | 否   | 引擎64_24.05.23新增 | 离开地图X  |
| y     | `integer` | 否   | 引擎64_24.05.23新增 | 离开地图Y  |

### 镜像地图销毁前触发

`mirrormapend`

| 参数   | 类型     | 空   | 默认 | 注释     |
| :----- | :------- | :--- | :--- | :------- |
| sysobj | `object` | 否   |      | 系统对象 |
| mapid  | `string` | 否   |      | 地图id   |

### 进入连接点(跳转点)前触

`beforeroute`

| 参数   | 类型      | 空   | 默认 | 注释                                |
| :----- | :-------- | :--- | :--- | :---------------------------------- |
| actor  | `object`  | 否   |      | 玩家对象                            |
| mapid  | `string`  | 否   |      | 地图id                              |
| x      | `integer` | 否   |      | x坐标                               |
| y      | `integer` | 否   |      | y坐标                               |
| result | `boolean` | 否   |      | 返回值<br />true=允许<br />false=不允许 |
------------

### 捡取触发

`pickupitemex`

| 参数          | 类型      | 空   | 默认                | 注释       |
| :------------ | :-------- | :--- | :------------------ | :--------- |
| actor         | `object`  | 否   |                     | 玩家对象   |
| itemobj       | `object`  | 否   |                     | 物品对象   |
| itemidx       | `integer` | 否   | 引擎64_24.03.14新增 | 物品id     |
| itemMakeIndex | `integer` | 否   | 引擎64_24.03.14新增 | 物品唯一id |
------------

### 奔跑触发

`run`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
------------

### 走路触发

`walk`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
------------

### 升级触发

`playlevelup`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

### 宝宝升级触发

`slaveupgrade`

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| mon   | `object` | 否   | 引擎64_23.12.07新增 | 宝宝对象 |
| level | `object` | 否   | 引擎64_23.12.07新增 | 当前等级 |
------------

### 小退出触发

`playreconnection`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
------------

### 大退与关闭客户端触发

`playoffline`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
------------

### 开始挂机触发

`startautoplaygame`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
------------

### 停止挂机触发

`stopautoplaygame`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
------------

### 属性变化时触发

`sendability`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

### 英雄属性变化时触发

`herosendability`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
| hero  | `object` | 否   |      | 英雄对象 |

------------

### 角色获取经验前触发

`getexp`

&gt; 注:脚本添加经验不会触发

| 参数   | 类型      | 空   | 默认 | 注释                   |
| :----- | :-------- | :--- | :--- | :--------------------- |
| actor  | `object`  | 否   |      | 玩家对象               |
| exp    | `integer` | 否   |      | 获取的经验值           |
| result | `integer` | 否   |      | 返回值，修改后的经验值 |

------------

###  拾取前触发

`pickupitemfrontex`

| 参数   | 类型     | 空   | 默认 | 注释                                |
| :----- | :------- | :--- | :--- | :---------------------------------- |
| actor  | `object` | 否   |      | 玩家对象                            |
| item   | `object` | 否   |      | 物品对象                            |
| result | `bool`   | 否   |      | true = 允许拾取<br />false = 阻止拾取 |
------------

### 角色/英雄获得宝宝触发

`slavebb`~`heroslavebb`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
| mon   | `object` | 否   |      | 宝宝对象 |

### 角色宝宝叛变触发

`mobtreachery`

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   | 引擎64_23.10.24新增 | 玩家对象 |
| mon   | `object` | 否   | 引擎64_23.10.24新增 | 宝宝对象 |

### 英雄宝宝叛变触发

`heromobtreachery`

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| hero  | `object` | 否   | 引擎64_23.10.24新增 | 英雄对象 |
| mon   | `object` | 否   | 引擎64_23.10.24新增 | 宝宝对象 |

------------

### 点击背包锁头触发

`closedbagitemclick`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
------------

### 货币超出21/42亿触发

&gt; 引擎64_23.08.30货币上限突破至42亿,该触发同步拓展至42亿

`changemoneyout`

| 参数     | 类型      | 空   | 默认 | 注释     |
| :------- | :-------- | :--- | :--- | :------- |
| actor    | `object`  | 否   |      | 玩家对象 |
| moneyIdx | `integer` | 否   |      | 货币id   |
| moneynum | `integer` | 否   |      | 货币数量 |

------------

### 套装激活触发

`groupitemon(X)`

&gt; X=套装编号

| 参数  | 类型      | 空   | 默认 | 注释     |
| :---- | :-------- | :--- | :--- | :------- |
| actor | `object`  | 否   |      | 玩家对象 |
| idx   | `string` | 否   |      | 套装id   |

### 穿套装触发

`groupitemonex`

| 参数  | 类型      | 空   | 默认 | 注释     |
| :---- | :-------- | :--- | :--- | :------- |
| actor | `object`  | 否   |      | 玩家对象 |
| idx   | `string` | 否   |      | 套装id   |

### 脱套装触发

`groupitemoffex`

| 参数   | 类型      | 空   | 默认 | 注释     |
| :----- | :-------- | :--- | :--- | :------- |
| actor  | `object`  | 否   |      | 玩家对象 |
| suitid | `string` | 否   |      | 套装id   |

### 英雄穿/脱套装触发

`herogroupitemonex`~`herogroupitemoffex`

| 参数   | 类型      | 空   | 默认                | 注释     |
| :----- | :-------- | :--- | :------------------ | :------- |
| actor  | `object`  | 否   |                     | 玩家对象 |
| suitid | `string` | 否   |                     | 套装id   |
| hero   | `object`  | 否   | 引擎64_23.10.24新增 | 英雄对象 |

### 英雄套装激活触发

`herogroupitemon(X)`

&gt; X=套装编号,参照套装配置说明

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| hero  | `object` | 否   | 引擎64_23.10.24新增 | 英雄对象 |

### 英雄开启首饰盒触发(神佑/生肖)

`heroopensndaitembox`

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| hero  | `object` | 否   | 引擎64_23.10.24新增 | 英雄对象 |

### 英雄忠诚度改变触发

`heroluck`

| 参数    | 类型      | 空   | 默认                | 注释     |
| :------ | :-------- | :--- | :------------------ | :------- |
| actor   | `object`  | 否   |                     | 玩家对象 |
| hero    | `object`  | 否   | 引擎64_23.10.24新增 | 英雄对象 |
| luckNum | `integer` | 否   | 引擎64_23.10.24新增 | 忠诚度   |

------------

### 交易前触发

`dealbefore`

| 参数  | 类型     | 空   | 默认 | 注释             |
| :---- | :------- | :--- | :--- | :--------------- |
| actor | `object` | 否   |      | 接收交易请求对象 |
| actor | `object` | 否   |      | 发起交易请求对象 |

### 交易后触发

`dealend`

| 参数  | 类型      | 空   | 默认 | 注释                 |
| :---- | :-------- | :--- | :--- | :------------------- |
| actor | `object`  | 否   |      | 玩家对象             |
| item  | `object`  | 否   |      | 最后一个物品的唯一ID |
| num   | `integer` | 否   |      | 交易物品的数量       |
------------

### 摆摊触发

`startmyshop`

&gt; forbidmyshop 接口打断摆摊

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

```lua
function startmyshop(actor)
    if getbaseinfo(actor,6) &lt; 50 then
        say(actor,"50级后才可摆摊")
        forbidmyshop(actor)
        return
    end
end

```

### 摆摊成功触发

`startmyshopok`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

### 商城购买后触发

`buyshopitem`

| 参数     | 类型      | 空   | 默认                | 注释     |
| :------- | :-------- | :--- | :------------------ | :------- |
| actor    | `object`  | 否   |                     | 玩家对象 |
| itemobj  | `object`  | 否   | 引擎64_23.12.07新增 | 物品对象 |
| itemname | `string`  | 否   | 引擎64_23.12.07新增 | 物品名称 |
| itemnum  | `integer` | 否   | 引擎64_23.12.07新增 | 物品数量 |
| moneyid  | `integer` | 否   | 引擎64_23.12.07新增 | 货币id   |
| moneynum | `integer` | 否   | 引擎64_23.12.07新增 | 物品价格 |

------------

### 人物勾选/取消外显时装生效触发

`showfashion` ~ `notshowfashion`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

### 英雄勾选/取消外显时装生效触发

`heroshowfashion` ~ `heronotshowfashion`

| 参数  | 类型     | 空   | 默认                | 注释     |
| :---- | :------- | :--- | :------------------ | :------- |
| actor | `object` | 否   |                     | 玩家对象 |
| hero  | `object` | 否   | 引擎64_23.08.30新增 | 英雄对象 |

------------

### 加好友前触发

`addfriendrequest`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |
------------

### 角色pk值变化触发
- 注:脚本设置pk值也会进入该触发,在触发中需要避免设置pk值造成死循环

`pkpointchanged`

| 参数    | 类型     | 空   | 默认 | 注释     |
| :------ | :------- | :--- | :--- | :------- |
| actor   | `object` | 否   |      | 角色对象 |
| pkpoint | `object` | 否   |      | pk值     |

### 英雄登陆触发

`herologin`

| 参数 | 类型     | 空   | 默认                | 注释     |
| :--- | :------- | :--- | :------------------ | :------- |
| play | `object` | 否   |                     | 玩家对象 |
| hero | `object` | 否   | 引擎64_23.08.30新增 | 英雄对象 |

------------

### 角色升级触发

`playlevelup`

| 参数  | 类型      | 空   | 默认                | 注释       |
| :---- | :-------- | :--- | :------------------ | :--------- |
| play  | `object`  | 否   |                     | 玩家对象   |
| level | `integer` | 否   | 引擎64_23.08.30新增 | 升级后等级 |

### 英雄升级触发

`herolevelup`

| 参数  | 类型      | 空   | 默认                | 注释       |
| :---- | :-------- | :--- | :------------------ | :--------- |
| play  | `object`  | 否   |                     | 玩家对象   |
| hero  | `object`  | 否   | 引擎64_23.08.30新增 | 英雄对象   |
| level | `integer` | 否   | 引擎64_23.08.30新增 | 升级后等级 |

------------

### 人物死亡之前

`nextdie`

| 参数   | 类型      | 空   | 默认 | 注释                             |
| :----- | :-------- | :--- | :--- | :------------------------------- |
| play   | `object`  | 否   |      | 玩家对象                         |
| hiter  | `object`  | 否   |      | 击杀者对象                       |
| isplay | `integer` | 否   |      | 0=击杀者非玩家<br />1=击杀者是玩家 |

### 英雄死亡前触发

`heronextdie`

| 参数   | 类型      | 空   | 默认                | 注释                             |
| :----- | :-------- | :--- | :------------------ | :------------------------------- |
| play   | `object`  | 否   |                     | 玩家对象                         |
| hiter  | `object`  | 否   |                     | 击杀者对象                       |
| isplay | `integer` | 否   |                     | 0=击杀者非玩家<br />1=击杀者是玩家 |
| hero   | `object`  | 否   | 引擎64_23.08.30新增 | 英雄对象                         |

------------

### 公众号获取KEY成功触发

`bindwechat`

| 参数  | 类型     | 空   | 默认                | 注释      |
| :---- | :------- | :--- | :------------------ | :-------- |
| actor | `object` | 否   |                     | 玩家对象  |
| key   | `string` | 否   | 引擎64_23.08.30新增 | 公众号key |

### 公众号成功验证触发

`bindrewechat`

| 参数  | 类型     | 空   | 默认                | 注释          |
| :---- | :------- | :--- | :------------------ | :------------ |
| actor | `object` | 否   |                     | 玩家对象      |

```
    常量获取:
    输入的微信KEY：&lt;$REWECHATKEY&gt;
    微信ID：&lt;$REWECHATID&gt;
```

------------

### 查看别人装备触发

`lookhuminfo`

| 参数  | 类型     | 空   | 默认                | 注释           |
| :---- | :------- | :--- | :------------------ | :------------- |
| actor | `object` | 否   |                     | 玩家对象       |
| name  | `string` | 否   | 引擎64_23.08.30新增 | 被查看的玩家名 |

------------

### 阅读邮件触发

`readmail`

| 参数      | 类型      | 空   | 默认                | 注释     |
| :-------- | :-------- | :--- | :------------------ | :------- |
| actor     | `object`  | 否   |                     | 玩家对象 |
| mailID    | `integer` | 否   | 引擎64_23.08.30新增 | 邮件id   |
| mailTitle | `string`  | 否   | 引擎64_23.08.30新增 | 邮件标题 |

### 邮件提取触发

`getmailitem`

| 参数      | 类型      | 空   | 默认                | 注释           |
| :-------- | :-------- | :--- | :------------------ | :------------- |
| actor     | `object`  | 否   |                     | 玩家对象       |
| mailID    | `integer` | 否   | 引擎64_23.08.30新增 | 邮件id         |
| mailTitle | `string`  | 否   | 引擎64_23.08.30新增 | 邮件标题       |
| itemJson  | `string`  | 否   | 引擎64_23.08.30新增 | 提取物品的json |

------------

### 拍卖行相关

&gt; 拍卖行相关触发都可用`allowpaimai`接口阻止本次行为

#### 拍卖行上架触发

`canpaimaiitem`

| 参数          | 类型      | 空   | 默认                | 注释       |
| :------------ | :-------- | :--- | :------------------ | :--------- |
| actor         | `object`  | 否   |                     | 玩家对象   |
| itemIdx       | `integer` | 否   |                     | 物品id     |
| itemMakeIndex | `integer` | 否   |                     | 物品唯一id |
| moneyType     | `integer` | 否   |                     | 货币类型   |
| price1        | `integer` | 否   |                     | 竞拍价     |
| price2        | `integer` | 否   | 引擎64_24.05.23新增 | 一口价     |

```lua
function canpaimaiitem(actor,itemIdx,itemMakeIndex,moneyType,price1,price2)
    if getbaseinfo(actor,6) &lt; 50 then
        say(actor,"禁止上架物品")
        allowpaimai(actor,1)
        [[23.0830前引擎需要调用TXT命令打断,callscriptex(actor,"allowpaimai","1")]]
        return
    end
end

```

#### 拍卖行重新上架前触发

`canrepaimaiitem`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.05.23新增接口&lt;/font&gt;**

| 参数          | 类型      | 空   | 默认 | 注释       |
| :------------ | :-------- | :--- | :--- | :--------- |
| actor         | `object`  | 否   |      | 玩家对象   |
| itemIdx       | `integer` | 否   |      | 物品id     |
| itemMakeIndex | `integer` | 否   |      | 物品唯一id |
| moneyType     | `integer` | 否   |      | 货币类型   |
| price1        | `integer` | 否   |      | 竞拍价     |
| price2        | `integer` | 否   |      | 一口价     |

```lua
function canrepaimaiitem(actor,itemIdx,itemMakeIndex,moneyType,price1,price2)
    if price2 &lt; 100 then
        say(actor,"一口价过低禁止上架!")
        allowpaimai(actor,1)
        return
    end
end

```

#### 拍卖行下架触发

`cangetbackpaimaiitem`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

#### 领取拍卖货币触发

`getpaimaiitem`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

#### 拍卖购买物品触发

`buypaimaiitem`

| 参数          | 类型      | 空   | 默认 | 注释       |
| :------------ | :-------- | :--- | :--- | :--------- |
| actor         | `object`  | 否   |      | 玩家对象   |
| itemIdx       | `integer` | 否   |      | 物品id     |
| itemMakeIndex | `integer` | 否   |      | 物品唯一id |
| moneyType     | `integer` | 否   |      | 货币类型   |
| price         | `integer` | 否   |      | 价格       |

```lua
function buypaimaiitem(actor,itemIdx,itemMakeIndex,moneyType,price)
    if getbaseinfo(actor,6) &lt; 50 then
        say(actor,"禁止购买物品")
        allowpaimai(actor,1)
        [[23.0830前引擎需要调用TXT命令打断,callscriptex(actor,"allowpaimai","1")]]
        return
    end
end

```

#### 拍卖行竞价触发

`biddingpaimaiitem`

| 参数          | 类型      | 空   | 默认 | 注释       |
| :------------ | :-------- | :--- | :--- | :--------- |
| actor         | `object`  | 否   |      | 玩家对象   |
| itemIdx       | `integer` | 否   |      | 物品id     |
| itemMakeIndex | `integer` | 否   |      | 物品唯一id |
| moneyType     | `integer` | 否   |      | 货币类型   |
| price         | `integer` | 否   |      | 价格       |

```lua
function buypaimaiitem(actor,itemIdx,itemMakeIndex,moneyType,price)
    if getbaseinfo(actor,6) &lt; 50 then
        say(actor,"禁止竞价物品")
        allowpaimai(actor,1)
        [[23.0830前引擎需要调用TXT命令打断,callscriptex(actor,"allowpaimai","1")]]
        return
    end
end

```

------------

### 采集怪相关

#### 采集前触发

`collectmonex`

| 参数         | 类型     | 空   | 默认 | 注释       |
| :----------- | :------- | :--- | :--- | :--------- |
| actor        | `string` | 否   |      | 玩家对象   |
| monIDX       | `number` | 否   |      | 怪物id     |
| monName      | `string` | 否   |      | 怪物名字   |
| monMakeIndex | `number` | 否   |      | 怪物唯一id |

#### 玩家点击采集怪物将会触发

`collectmon(X)`

&gt; X=怪物ID

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `string` | 否   |      | 玩家对象 |
| mon   | `string` | 否   |      | 怪物对象 |
------------

### 传送戒指传送前触发

`beginteleport`

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `string` | 否   |      | 玩家对象 |
| X     | `number` | 否   |      | X坐标    |
| Y     | `number` | 否   |      | Y坐标    |

