

## 人物属性

### 修改人物名称

`changehumname`

| 参数   | 类型      | 空   | 默认 | 注释                                                                                               |
| :----- | :-------- | :--- | :--- | :------------------------------------------------------------------------------------------------- |
| play   | `object`  | 否   |      | 玩家对象                                                                                           |
| name   | `string`  | 否   |      | 要查询的名字                                                                                       |
| result | `integer` |      |      | 执行结果：<br />0-改名成功<br />1、2、6-名称被过滤<br />3-名字已经存在<br />5-长度不符合要求<br />7-改名失败 |
```lua
1. 会先执行查询人物名称操作，并触发：queryinghumname;
2. 会根据查询结果情况触发：humnamefilter（名称被过滤）、namelengthfail（长度不符合要求）、humnameexists（名称已经存在）;
3. 执行改名操作前触发：changeinghumname，根据改名结果触发：changehumnameok(改名成功)、changehumnamefail(改名失败)。
	
--正在查询玩家名称
function queryinghumname(actor)
    sendmsg(actor, 1, '{"Msg":"&lt;font color=\'#ff0000\'&gt;正在查询请稍后。。。&lt;/font&gt;","Type":9}')
end

--名称被过滤
function humnamefilter(actor)
    sendmsg(actor, 1, '{"Msg":"&lt;font color=\'#ff0000\'&gt;名称被过滤。。。&lt;/font&gt;","Type":9}')
end

--长度不符合要求
function namelengthfail(actor)
    sendmsg(actor, 1, '{"Msg":"&lt;font color=\'#ff0000\'&gt;长度不符合要求&lt;/font&gt;","Type":9}')
end

--名称已经存在
function humnameexists(actor)
    sendmsg(actor, 1, '{"Msg":"&lt;font color=\'#ff0000\'&gt;名称已经存在&lt;/font&gt;","Type":9}')
end

--正在执行改名操作
function changeinghumname(actor)
    sendmsg(actor, 1, '{"Msg":"&lt;font color=\'#ff0000\'&gt;正在修改请稍后。。。&lt;/font&gt;","Type":9}')
end

--改名成功
function changehumnameok(actor)
    sendmsg(actor, 1, '{"Msg":"&lt;font color=\'#ff0000\'&gt;'..parsetext("你的名字修改成功，旧名称：&lt;$USERNAME&gt; 新名称：&lt;$USERNEWNAME&gt;！",actor)..'&lt;/font&gt;","Type":9}')
end

--改名失败
function changehumnamefail(actor)
    sendmsg(actor, 1, '{"Msg":"&lt;font color=\'#ff0000\'&gt;修改名称失败&lt;/font&gt;","Type":9}')
end
```

### 修改人物名字颜色
`changenamecolor`

| 参数  | 类型      | 空   | 默认 | 注释     |
| :---- | :-------- | :--- | :--- | :------- |
| play  | `object`  | 否   |      | 玩家对象 |
| color | `integer` | 否   |      | 颜色索引 |

### 刷新人物属性
`recalcabilitys`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |

### 获取人物属性
`gethumability`

| 参数   | 类型      | 空   | 默认 | 注释                 |
| :----- | :-------- | :--- | :--- | :------------------- |
| play   | `object`  | 否   |      | 玩家对象             |
| id     | `integer` | 否   |      | 属性ID（1-20）       |
| result | `integer` | 否   |      | 返回值，对应的属性值 |

### 调整人物属性
`changehumability`

| 参数  | 类型      | 空   | 默认 | 注释           |
| :---- | :-------- | :--- | :--- | :------------- |
| play  | `object`  | 否   |      | 玩家对象       |
| id    | `integer` | 否   |      | 属性ID（1-20） |
| value | `integer` | 否   |      | 属性值         |
| time  | `integer` | 否   |      | 时间(秒)       |
* 属性ID
1=防御下限 
2=防御上限 
3=魔御下限 
4=魔御上限 
5=攻击下限 
6=攻击上限 
7=魔法下限 
8=魔法上限
9=道术下限 
10=道术上限 
11=MaxHP 
12=MaxMP 
13=HP恢复 
14=MP恢复
15=毒恢复 
16=毒躲避 
17=魔法躲避 
18=准确 
19=敏捷 
20= 幸运

### 修改人物临时属性（带有效期）
`changehumnewvalue`

| 参数   | 类型      | 空   | 默认 | 注释                          |
| :----- | :-------- | :--- | :--- | :---------------------------- |
| play   | `object`  | 否   |      | 玩家对象                      |
| nWhere | `integer` | 否   |      | 位置 对应cfg_att_score 属性ID |
| nValue | `integer` | 否   |      | 对应属性值                    |
| nTime  | `integer` | 否   |      | 有效时间，秒                  |

```lua
function main(self)
    changehumnewvalue(self,10,10,10)
end
```

### 获取人物临时属性
`gethumnewvalue`

| 参数   | 类型      | 空   | 默认 | 注释                          |
| :----- | :-------- | :--- | :--- | :---------------------------- |
| play   | `object`  | 否   |      | 玩家对象                      |
| nWhere | `integer` | 否   |      | 位置 对应cfg_att_score 属性ID |
| result | `integer` | 否   |      | 对应属性值                    |

### 获取人物永久属性
`getusebonuspoint`

| 参数   | 类型      | 空   | 默认 | 注释       |
| :----- | :-------- | :--- | :--- | :--------- |
| play   | `object`  | 否   |      | 玩家对象   |
| nIndex | `integer` | 否   |      | 索引       |
| result | `integer` | 否   |      | 对应属性值 |

### 设置人物永久属性
`setusebonuspoint`

| 参数   | 类型      | 空   | 默认 | 注释       |
| :----- | :-------- | :--- | :--- | :--------- |
| play   | `object`  | 否   |      | 玩家对象   |
| nIndex | `integer` | 否   |      | 索引       |
| nvalue | `integer` | 否   |      | 对应属性值 |

nIndex 取值
1：攻击下限（0~65535）
2：攻击上限（0~65535）
3：魔法下限（0~65535）
4：魔法上限（0~65535）
5：道术下限（0~65535）
6：道术上限（0~65535）
7：防御下限（0~65535）
8：防御上限（0~65535）
9：魔防下限（0~65535）
10：魔防上限（0~65535）
11：生命值（支持21亿）
12：魔法值（支持21亿）
13：准确（支持21亿）
14：躲避（支持21亿）
15：防御下限（支持21亿）
16：防御上限（支持21亿）
17：魔防下限（支持21亿）
18：魔防上限（支持21亿）

------------

### 通过字符串增加对应属性值(参照cfg_equip.xls属性字段)

`addattlist`

| 参数    | 类型      | 空   | 默认 | 注释                                                                                                     |
| :------ | :-------- | :--- | :--- | :------------------------------------------------------------------------------------------------------- |
| play    | `object`  | 否   |      | 玩家对象                                                                                                 |
| attridx | `string`  | 否   |      | 自定义属性组名称                                                                                         |
| opt     | `string`  | 否   |      | 操作符 +、-、=                                                                                           |
| attrStr | `string`  | 否   |      | 属性字符串                                                                                               |
| type    | `integer` | 是   | 0    | 0=计算套装属性增加;<br />1=增加固定值;不计算套装属性(属性加成类无效)<br />2=全部属性计算完后<br />最后增加属性 |

```lua
    --加属性
    addattlist(actor,"属性组1","+","3#1#100|3#2#100|3#3#10|3#4#10")
```

### 获取字符串属性

`getattlist`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**
 

| 参数    | 类型     | 空   | 默认 | 注释             |
| :------ | :------- | :--- | :--- | :--------------- |
| play    | `object` | 否   |      | 玩家对象         |
| attridx | `string` | 否   |      | 自定义属性组名称 |
| result  | `string` | 否   |      | 属性字符串       |
```lua
    local attr_str = getattlist(actor,"自定义属性组1")
    release_print("attr_str",attr_str)
```

### 清除字符串属性
`delattlist`

| 参数    | 类型     | 空   | 默认 | 注释             |
| :------ | :------- | :--- | :--- | :--------------- |
| play    | `object` | 否   |      | 玩家对象         |
| attridx | `string` | 否   |      | 自定义属性组名称 |

```lua
    --删属性
    delattlist(actor,"属性组1")
```

------------

### 设置装备部位属性加成(万分比)

 `setequipaddvalue`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**
 
| 参数  | 类型      | 空   | 默认 | 注释          |
| :---- | :-------- | :--- | :--- | :------------ |
| play  | `object`  | 否   |      | 玩家对象      |
| where | `integer` | 否   |      | 装备部位      |
| sFlag | `string`  | 否   |      | 操作符(=,+,-) |
| pro   | `integer` | 是   |      | 倍数(万分比)  |
```lua
setequipaddvalue(actor,1 ,"+", 15000)
say(actor,"武器部位的属性加成".. getequipaddvalue(actor,1))
```

### 获取装备部位属性加成(万分比)

 `getequipaddvalue`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**
 
| 参数   | 类型      | 空   | 默认 | 注释         |
| :----- | :-------- | :--- | :--- | :----------- |
| play   | `object`  | 否   |      | 玩家对象     |
| where  | `integer` | 否   |      | 装备部位     |
| result | `bool`    | 是   |      | 倍数(万分比) |

------------

### 设置人物经验值
`changeexp`

| 参数   | 类型      | 空   | 默认 | 注释               |
| :----- | :-------- | :--- | :--- | :----------------- |
| play   | `object`  | 否   |      | 玩家对象           |
| opt    | `char`    | 否   |      | 操作符 + - =       |
| count  | `integer` | 否   |      | 数量               |
| addexp | `bool`    | 否   |      | 是否增加聚灵珠经验 |

### 调整人物等级
`changelevel`

| 参数  | 类型      | 空   | 默认 | 注释         |
| :---- | :-------- | :--- | :--- | :----------- |
| play  | `object`  | 否   |      | 玩家对象     |
| opt   | `char`    | 否   |      | 操作符 + - = |
| count | `integer` | 否   |      | 数量         |

### 设置等级锁

`setlocklevel`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.05.23新增接口&lt;/font&gt;**

| 参数  | 类型      | 空   | 默认 | 注释                                                                                       |
| :---- | :-------- | :--- | :--- | :----------------------------------------------------------------------------------------- |
| actor | `object`  | 否   |      | 玩家对象                                                                                   |
| itype | `integer` | 否   |      | 0:解除锁定<br />1锁定到达最大等级时并且不获取怪物经验<br />2:锁定到达最大等级时累积经验(int64) |
| level | `integer` | 否   |      | 锁住最大等级                                                                               |
```lua
[[
    特殊*：设置等级锁后 ,changeexp 仍然可以加经验, setbaseinfo 仍然可以突破等级限制
    特殊*：重进游戏需要重新设置
]]
    setlocklevel(actor,1,99)
```

------------

### 改变人物模式

`changemode`

| 参数   | 类型      | 空   | 默认 | 注释                                           |
| :----- | :-------- | :--- | :--- | :--------------------------------------------- |
| play   | `object`  | 否   |      | 玩家对象                                       |
| mode   | `integer` | 否   |      | 模式1~24                                       |
| time   | `integer` | 否   |      | 状态时间(秒,1-65535)                           |
| param1 | `integer` | 否   |      | 参数1,12,13,18,20,21代表几率<br />其余代表属性值 |
| param2 | `integer` | 否   |      | 参数2                                          |

- 具体参考脚本命令说明
//说明: 1=无敌 2=隐身 3=HP 4=MP 5=攻击力 6=魔法力 7=道术力 8=攻击速度 9=禁止攻击 10=锁定
//如果是禁锢时，第三个参数表示禁锢范围
//11 禁锢[释放一个类似困魔咒的光圈，敌对人物只能在这个圈子里移动，无法走出圈子外面，所有传送失效，不能小退] param1:禁锢范围 param2:1表示不禁锢自己;2表示禁锢自己;0或空按之前的
//12 冰冻[设置后可以使攻击目标冰冻] param1:几率 param2:冰冻时间(秒)
//13 蛛网[设置后可以使攻击目标中蛛网] param1:几率 param2:蛛网时间(秒)
//14 防麻痹
//15 防禁锢
//16 防冰冻
//17 防蛛网
//18 麻痹[设置后可以使攻击目标麻痹]param1:几率 param2:麻痹时间(秒)
//19 护身 param1:掉蓝比例 param2:伤害吸收(设置数值除以100)
//20 吸血 param1:吸血几率(百分比) param2:吸血点数(万分比)
//21 吸蓝 param1:吸蓝几率(百分比) param2:吸蓝点数(万分比)
//22 隐身(类似隐身戒指)
//23 复活
//24 破复活

```lua
    --角色无敌，无敌时长60秒
    changemode(actor, 1, 60)

    --禁锢自身10秒,范围3格
    changemode(actor,11, 10, 3, 0)

    --禁锢自身10秒,范围3格(禁锢的是他人，没有禁锢自己)
    changemode(actor,11, 10, 3, 1)

    --可以使目标冰冻，冰冻机率1/100(数字越大机率越低)，冰冻时长3秒 
    changemode(actor,12,100,1,3)

    --可以使目标中蛛网，中网机率1/10(数字越大机率越低)，蛛网时长3秒 
    changemode(actor,13,10,1,3)

    --10秒内可以防麻痹
    changemode(actor,14,10)

    --可以使目标麻痹，麻痹机率1/1(数字越大机率越低)，麻痹时长3秒
    changemode(actor,18,1,1,3)

    --10秒内攻击目标，可以吸血，吸血机率100(数字越大机率越高 100表示每次都会吸血)，5000代表吸血百分比50%(比如攻击伤害值是10000，50%的吸血比例，可以吸血5000) 
    changemode(actor,20,10,100, 5000)
```

------------

### 顶戴花翎
`seticon`

| 参数     | 类型      | 空   | 默认               | 注释                                                    |
| :------- | :-------- | :--- | :----------------- | :------------------------------------------------------ |
| play     | `object`  | 否   |                    | 玩家对象                                                |
| where    | `integer` | 否   |                    | 位置 0-9                                                |
| effType  | `integer` | 否   |                    | 播放效果<br />0 = 图片名称<br />1 = 特效ID<br />-1 = 取消顶戴 |
| resName  | `string`  | 否   |                    | 图片名或者特效ID                                        |
| x        | `integer` | 否   |                    | X坐标 (为空时默认X=0)                                   |
| y        | `integer` | 否   |                    | Y坐标 (为空时默认Y=0)                                   |
| autoDrop | `integer` | 否   |                    | 自动补全空白位置0,1(0=掉 1=不掉)                        |
| selfSee  | `integer` | 否   |                    | 是否只有自己看见<br />0=所有人都可见;<br />1=仅仅自己可见;  |
| posM     | `integer` | 否   | 引擎64_23.0628新增 | 播放位置(不填默认为0)<br />0=在角色之上;<br />1=在角色之下; |
```lua
 --添加顶戴效果
 seticon(actor, 0, 1, 200, -30, 100, 0, 0, 1)

 --移除顶戴效果
 seticon(actor, 0, -1)
```

### 在人物身上播放特效
`playeffect`

| 参数     | 类型      | 空   | 默认 | 注释                                       |
| :------- | :-------- | :--- | :--- | :----------------------------------------- |
| play     | `object`  | 否   |      | 玩家对象                                   |
| effectid | `integer` | 否   |      | 特效ID                                     |
| offsetX  | `integer` | 否   |      | 相对于人物偏移的X坐标                      |
| offsetY  | `integer` | 否   |      | 相对于人物偏移的Y坐标                      |
| times    | `integer` | 否   |      | 播放次数<br />0-一直播放                     |
| behind   | `integer` | 否   |      | 播放模式<br />0-前面<br />1-后面               |
| selfshow | `integer` | 否   |      | 仅自己可见<br />0-否，视野内均可见，<br />1-是 |

### 清除人物身上播放的特效
`clearplayeffect`

| 参数     | 类型      | 空   | 默认 | 注释     |
| :------- | :-------- | :--- | :--- | :------- |
| play     | `object`  | 否   |      | 玩家对象 |
| effectid | `integer` | 否   |      | 特效ID   |

```
注：已经指定播放数量的特效，不能用此命令清除
```

------------

### 修改人物当前血量

`humanhp`

| 参数    | 类型      | 空   | 默认                          | 注释                                                                |
| :------ | :-------- | :--- | :---------------------------- | :------------------------------------------------------------------ |
| play    | `object`  | 否   |                               | 玩家(怪物)对象                                                      |
| operate | `string`  | 否   |                               | 操作符号<br />"+" 增加<br />"-" 减少<br />"=" 等于                        |
| nvalue  | `integer` | 否   |                               | HP点数                                                              |
| effid   | `integer` | 否   |                               | 素材ID                                                              |
| delay   | `integer` | 否   | 引擎64_23.03.23后<br />支持小数 | 延时时间(秒)                                                        |
| hiter   | `object`  | 是   | 引擎64_23.06.28新增           | 伤害来源对象                                                        |
| isSend  | `integer` | 是   | 引擎64_23.10.24新增           | 释放广播飘血<br />0/nil=不广播<br />1=广播                              |
| isRob   | `integer` | 是   | 引擎64_24.03.14新增           | 是否强制修改归属<br />0/nil=强制修改归属;<br />1=已有归属的情况不抢归属 |
```
    参数4[素材ID] effid = cfg_damage_number表中的ID编号，ID可自行增加和配置
```

### 修改人物当前MP

`humanmp`

| 参数    | 类型      | 空   | 默认 | 注释                                         |
| :------ | :-------- | :--- | :--- | :------------------------------------------- |
| play    | `object`  | 否   |      | 玩家对象                                     |
| operate | `string`  | 否   |      | 操作符号<br />'+'-增加<br />'-'-减少<br />'='-等于 |
| nvalue  | `integer` | 否   |      | MP点数                                       |

### 调整HP(血量)的百分比

`addhpper`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.10.24新增接口&lt;/font&gt;**

| 参数   | 类型      | 空   | 默认 | 注释           |
| :----- | :-------- | :--- | :--- | :------------- |
| player | `object`  | 否   |      | 玩家(怪物)对象 |
| opt    | `string`  | 否   |      | 控制符(=,+,-)  |
| value  | `integer` | 否   |      | 数值           |

### 调整MP(蓝量)的百分比

`addmpper`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.10.24新增接口&lt;/font&gt;**

| 参数   | 类型      | 空   | 默认 | 注释          |
| :----- | :-------- | :--- | :--- | :------------ |
| player | `object`  | 否   |      | 玩家对象      |
| opt    | `string`  | 否   |      | 控制符(=,+,-) |
| value  | `integer` | 否   |      | 数值          |

### 设置人物伤害吸收
`setsuckdamage`

| 参数    | 类型      | 空   | 默认 | 注释                                         |
| :------ | :-------- | :--- | :--- | :------------------------------------------- |
| play    | `object`  | 否   |      | 玩家对象                                     |
| operate | `string`  | 否   |      | 操作符号<br />'+'-增加<br />'-'-减少<br />'='-等于 |
| sum     | `integer` | 否   |      | 总吸收量                                     |
| rate    | `integer` | 否   |      | 吸收比率，千分比<br />1=0.1%，100=10%          |
| success | `integer` | 否   |      | 吸收成功率                                   |

### 获取人物伤害吸收
`getsuckdamage`

| 参数   | 类型      | 空   | 默认 | 注释       |
| :----- | :-------- | :--- | :--- | :--------- |
| play   | `object`  | 否   |      | 玩家对象   |
| result | `integer` | 否   |      | 伤害吸收值 |
```lua
    setsuckdamage(actor,"=",1000,200,95)
    local damage = getsuckdamage(actor)
    release_print("伤害吸收值",damage)
```

------------

### 人物变色
`setbodycolor`

| 参数  | 类型      | 空   | 默认 | 注释                                                                     |
| :---- | :-------- | :--- | :--- | :----------------------------------------------------------------------- |
| play  | `object`  | 否   |      | 玩家对象                                                                 |
| color | `integer` | 否   |      | 颜色(0~255); 255时清除颜色;     -1则为转生设置的颜色在人物身体上进行变色 |
| time  | `integer` | 否   |      | 改变时长(秒)                                                             |

### 播放光环效果
`mobfireburn`

| 参数     | 类型      | 空   | 默认 | 注释                                                         |
| :------- | :-------- | :--- | :--- | :----------------------------------------------------------- |
| play     | `object`  | 否   |      | 玩家对象                                                     |
| mapid    | `string`  | 否   |      | 地图id                                                       |
| x        | `integer` | 否   |      | 坐标x                                                        |
| y        | `integer` | 否   |      | 坐标y                                                        |
| type     | `integer` | 否   |      | 光环类型<br />1=僵尸钻的地洞<br />3=碎石块<br />4=困魔光<br />5=火墙 |
| time     | `integer` | 否   |      | 时间（秒）                                                   |
| behind   | `integer` | 否   |      | 播放模式-0-前面-1-后面                                       |
| selfshow | `integer` | 否   |      | 仅自己可见0-否，视野内均可见，1-是                           |

------------

### 脚本设置防秒杀功能
`killedprotect`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |
```
说明：当前你血量100%的时候敌方第一刀伤害打掉你多少血量，如果你血量不是100%的时候防秒杀功能不生效
```

### 立即杀死角色
`kill`

| 参数      | 类型     | 空   | 默认 | 注释       |
| :-------- | :------- | :--- | :--- | :--------- |
| play      | `object` | 否   |      | 角色的对象 |
| strKiller | `object` | 否   |      | 凶手的对象 |

------------

## 人物货币

### 查询人物货币
`querymoney`

| 参数   | 类型      | 空   | 默认 | 注释            |
| :----- | :-------- | :--- | :--- | :-------------- |
| play   | `object`  | 否   |      | 玩家对象        |
| id     | `integer` | 否   |      | 货币ID（1-100） |
| result | `integer` | 否   |      | 对应货币值      |

### 设置人物货币
`changemoney`

| 参数   | 类型      | 空   | 默认 | 注释                        |
| :----- | :-------- | :--- | :--- | :-------------------------- |
| play   | `object`  | 否   |      | 玩家对象                    |
| id     | `integer` | 否   |      | 货币ID（1-100）             |
| opt    | `char`    | 否   |      | 操作符 + - =                |
| count  | `integer` | 否   |      | 数量                        |
| msg    | `string`  | 否   |      | 备注内容                    |
| send   | `bool`    | 否   |      | 是否推送到客户端，true-更新 |
| result | `bool`    | 否   |      | 是否成功                    |

### 获取人物通用货币数量(多货币计算)
`getbindmoney`

| 参数      | 类型      | 空   | 默认 | 注释       |
| :-------- | :-------- | :--- | :--- | :--------- |
| play      | `object`  | 否   |      | 玩家对象   |
| moneyname | `string`  | 否   |      | 货币名称   |
| result    | `integer` | 否   |      | 对应货币值 |

```
表：cfg_item.xls表，设置方法：Reserved字段 
货币组分类(数字)#优先扣除顺序，如：22#1 22#2 22#3
这3个货币是一个类别的，后面的1 2 3 代表扣除的顺序，数字越小越优先扣除。
```

### 扣除人物通用货币数量(多货币依次计算)

`consumebindmoney`

| 参数      | 类型      | 空   | 默认                | 注释       |
| :-------- | :-------- | :--- | :------------------ | :--------- |
| play      | `object`  | 否   |                     | 玩家对象   |
| moneyname | `string`  | 否   |                     | 货币名称   |
| count     | `integer` | 否   |                     | 对应货币值 |
| msg       | `string`  | 否   | 引擎64_23.08.30新增 | 备注内容   |
| result    | `bool`    | 否   | 引擎64_23.12.07新增 | 是否成功   |

------------

## 人物装备

### 设置人物背包格子数
`setbagcount`

| 参数  | 类型      | 空   | 默认 | 注释                                |
| :---- | :-------- | :--- | :--- | :---------------------------------- |
| play  | `object`  | 否   |      | 玩家对象                            |
| count | `integer` | 否   |      | 格子大小<br />（不小于46，不大于126） |

### 获取背包剩余空格数
`getbagblank`

| 参数   | 类型      | 空   | 默认 | 注释           |
| :----- | :-------- | :--- | :--- | :------------- |
| play   | `object`  | 否   |      | 玩家对象       |
| result | `integer` | 否   |      | 背包剩余格子数 |

### 遍历背包勾选物品
`selectbagitems`

| 参数      | 类型     | 空   | 默认 | 注释                                  |
| :-------- | :------- | :--- | :--- | :------------------------------------ |
| play      | `object` | 否   |      | 玩家对象                              |
| makeindex | `string` | 否   |      | 选中的物品唯一ID<br />多个物品用“,”分隔 |

------------

### 穿戴装备
`takeonitem`

| 参数      | 类型      | 空   | 默认 | 注释       |
| :-------- | :-------- | :--- | :--- | :--------- |
| play      | `object`  | 否   |      | 玩家对象   |
| where     | `integer` | 否   |      | 位置       |
| makeindex | `integer` | 否   |      | 物品唯一ID |

### 脱下装备
`takeoffitem`

| 参数  | 类型      | 空   | 默认 | 注释     |
| :---- | :-------- | :--- | :--- | :------- |
| play  | `object`  | 否   |      | 玩家对象 |
| where | `integer` | 否   |      | 位置     |

------------

### 开/关首饰盒
`setsndaitembox`

| 参数   | 类型      | 空   | 默认 | 注释             |
| :----- | :-------- | :--- | :--- | :--------------- |
| play   | `object`  | 否   |      | 玩家对象         |
| bState | `integer` | 否   |      | 0：关闭，1：开启 |

### 修改武器、衣服外观

`changeitemshape`

| 参数  | 类型      | 空   | 默认 | 注释     |
| :---- | :-------- | :--- | :--- | :------- |
| play  | `object`  | 否   |      | 玩家对象 |
| item  | `object`  | 否   |      | 物品对象 |
| looks | `integer` | 否   |      | 外观值   |

### 修改武器、衣服特效
`changedresseffect`

| 参数    | 类型      | 空   | 默认 | 注释                                            |
| :------ | :-------- | :--- | :--- | :---------------------------------------------- |
| play    | `object`  | 否   |      | 玩家对象                                        |
| where   | `integer` | 否   |      | 位置 0，1                                       |
| EffId   | `integer` | 否   |      | 特效ID                                          |
| selfSee | `integer` | 否   |      | 是否只有自己看见(1=所有人都可见 0=仅仅自己可见) |

### 修改角色外观(武器、衣服、特效)

`setfeature`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**

| 参数   | 类型      | 空   | 默认 | 注释                                                                                                            |
| :----- | :-------- | :--- | :--- | :-------------------------------------------------------------------------------------------------------------- |
| play   | `object`  | 否   |      | 玩家对象                                                                                                        |
| type   | `integer` | 否   |      | 0=衣服;1=武器;<br />2=衣服特效(翅膀);<br />3武器特效;<br />4=盾牌;5=盾牌特效<br />6=左手武器;7=左手武器特效             |
| shape  | `integer` | 否   |      | 外观的shape(角色模型ID),-1表示清除                                                                              |
| time   | `integer` | 否   |      | 时间 (秒)                                                                                                       |
| param1 | `integer` | 否   |      | 仅在参数1位置为0时有效<br />0=覆盖时装外观<br />1=时装外观优先                                                      |
| param2 | `integer` | 否   |      | 仅在参数1位置为0时有效<br />0-斗笠、头发不变<br />1-隐藏斗笠<br />2-隐藏头发<br />3-隐藏斗笠和头发 4-隐藏盾牌和盾牌特效 |
```lua
    setfeature(actor,0,2,65535,0,3)

    --翅膀特效
    setfeature(actor,2,3,65535,0,0)
```

------------

### 检测装备的元素属性
`checknewitemvalue`

| 参数   | 类型      | 空   | 默认 | 注释                                             |
| :----- | :-------- | :--- | :--- | :----------------------------------------------- |
| play   | `object`  | 否   |      | 玩家对象                                         |
| where  | `integer` | 否   |      | 装备位置：<br />-1-OK框中的装备<br />0~55-身上的装备 |
| iAttr  | `integer` | 否   |      | 属性                                             |
| sFlag  | `string`  | 否   |      | 比较符（=&lt;&gt;）                                    |
| iValue | `integer` | 否   |      | 数值(1-100)，百分比                              |
```
(0)暴击几率增加 1~100%
(1)增加攻击伤害 1~100%
(2)物理伤害减少 1~100%
(3)魔法伤害减少 1~100%
(4)忽视目标防御 1~100%
(5)所有伤害反弹 1~100%
(6)增加目标暴率 1~100%
(7)人物体力增加 1~100%
(8)人物魔力增加 1~100%
(11)暴击伤害增加 1~100%
```

### 给人物装备面板加特效
`updateequipeffect`

| 参数     | 类型      | 空   | 默认 | 注释                    |
| :------- | :-------- | :--- | :--- | :---------------------- |
| play     | `object`  | 否   |      | 玩家对象                |
| effectid | `integer` | 否   |      | 特效ID， 0-删除特效     |
| position | `integer` | 否   |      | 显示位置：0-前面 1-后面 |

------------

## 技能魔法

### 获取技能信息
`getskillinfo`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillid | `integer`    |否   |    |   技能ID  |
|type     | `integer`       |否   | 4:熟练度上限<br />引擎64_23.0628新增   |   获取类型:<br />1:等级;<br />2:强化等级;<br />3:熟练度;<br />4:熟练度上限;    |
|result       | `integer`       |否   |   |   返回值(对应属性值) ,没有技能，返回nil   |

### 添加技能
`addskill`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillid | `integer`    |否   |    |   技能ID  |
|level    | `integer`       |否   |    |   等级   |

### 删除技能
`delskill`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillid | `integer`    |否   |    |   技能ID  |

```lua
function main(self)
    local lv = getskillinfo(self,11,1)
    if lv and lv &gt;0 then
        delskill(self, 11)
        say(self,"删除雷电术")
    else
        addskill(self, 11, 3)
        say(self,"获得雷电术") 
    end
end
```

### 清空所有技能
`clearskill`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |

### 删除非本职业技能
`delnojobskill`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |

### 设置技能等级
`setskillinfo`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillid     | `integer`    |否   |    |   技能ID |
|flag     | `integer`    |否   |    |   类型：<br />1-技能等级<br />2-强化等级<br />3-熟练度 |
|point     | `integer`    |否   |    |   等级或点数 |

### 接口获取角色所有技能

`getallskills`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.08.07新增接口&lt;/font&gt;**

| 参数   | 类型     | 空   | 默认 | 注释     |
| :----- | :------- | :--- | :--- | :------- |
| actor  | `object` | 否   |      | 玩家对象 |
| result | `table`  | 否   |      | 技能列表 |
```lua
    local skill_list = getallskills(actor)
    for _, skillID in ipairs(skill_list or {}) do
        release_print("技能", skillID )
    end
```

------------

### 用脚本命令释放技能

`releasemagic`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillid     | `integer`    |否   |    |   技能ID |
|type     | `integer`    |否   |    |   类型：<br />1-普通技能<br />2-强化技能 |
|level     | `integer`    |否   |    |  技能等级 |
|target     | `integer`    |否   |    | 技能对象：<br />1-攻击目标，<br />2-自身|
|flag     | `integer`    |否   |    |   是否显示施法动作：<br />0-不显示，1-显示 |

### 对目标释放技能

`releasemagic_target`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.05.23新增接口&lt;/font&gt;**

| 参数    | 类型      | 空   | 默认 | 注释                                   |
| :------ | :-------- | :--- | :--- | :------------------------------------- |
| actor   | `object`  | 否   |      | 玩家对象                               |
| skillID | `integer` | 否   |      | 技能ID                                 |
| sType   | `integer` | 否   |      | 类型<br />1-普通技能<br />2-强化技能       |
| sLevel  | `integer` | 否   |      | 技能等级                               |
| target  | `object`  | 否   |      | 目标对象                               |
| data    | `integer` | 是   | 0    | 是否显示施法动作<br />0-不显示<br />1-显示 |
```lua
    releasemagic_target(actor,skill_id,1,skill_lv,mon,0)
```

### 对坐标释放技能

`releasemagic_pos`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.05.23新增接口&lt;/font&gt;**

| 参数    | 类型      | 空   | 默认 | 注释                                   |
| :------ | :-------- | :--- | :--- | :------------------------------------- |
| actor   | `object`  | 否   |      | 玩家对象                               |
| skillID | `integer` | 否   |      | 技能ID                                 |
| sType   | `integer` | 否   |      | 类型<br />1-普通技能<br />2-强化技能       |
| sLevel  | `integer` | 否   |      | 技能等级                               |
| X       | `integer` | 否   |      | 目标点X坐标                            |
| Y       | `integer` | 否   |      | 目标点Y坐标                            |
| data    | `integer` | 是   | 0    | 是否显示施法动作<br />0-不显示<br />1-显示 |
```lua
    releasemagic_pos(actor,skill_id,1,skill_lv,pos_X,pos_Y,0)
```

------------

### 设置人物攻击力倍数
`powerrate`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|rate     | `integer`    |否   |    |  攻击威力比率，100=100% |
|time     | `integer`    |否   |    |  有效时间，超过时间恢复正常 |

### 减少技能CD冷却时间
`setskilldeccd`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillname     |`string`    |否   |    |  技能名称 |
|char     |`string`    |否   |    |  操作符(+/-/=) <br />=0就是还原技能CD|
|time     | `integer`    |否   |    | 时间（秒) |

### 获取技能初始冷却时间
`getskillcscd`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|skillname     |`string`    |否   |    |  技能名称 |
|result     | `integer`    |否   |    |  冷却时间(毫秒) |

### 获取当前技能冷却时间
`getskilldqcd`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillname     |`string`    |否   |    |  技能名称 |
|result     | `integer`    |否   |    |  冷却时间(毫秒) |

### 重置技能冷却时间

`skillrestcd`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.03.14新增接口&lt;/font&gt;**

| 参数              | 类型               | 空   | 默认                    | 注释                               |
| :---------------- | :----------------- | :--- | :---------------------- | :--------------------------------- |
| actor             | `string`           | 否   |                         | 玩家对象                           |
| skillName/skillID | `string`/`integer` | 否   |                         | 技能名称/技能ID                    |
| time              | `integer`          | 是   | 引擎64_24.05.23新增参数 | 减免的cd时间<br />传入0则重置技能CD  |
| timeType          | `integer`          | 是   | 引擎64_24.08.07新增参数 | 0=时间单位为秒<br />1=时间单位为毫秒 |

### 获取技能等级
`getskilllevel`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillid     | `integer`    |否   |    |   技能ID |

### 获取技能强化等级
`getskilllevelup`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillid     | `integer`    |否   |    |   技能ID |

### 获取技能熟练度
`getskilltrain`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillid     | `integer`    |否   |    |   技能ID |

### 增加技能威力
`setmagicpower`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillname     |`string`    |否   |    |  技能名称 |
|value     | `integer`    |否   |    |  威力值 |
|type     | `integer`    |否   |    |  计算方式(0按点数计算,1按百分比计算) |

### 增加技能防御力
`setmagicdefpower`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|play     |`object`    |否   |    |   玩家对象 |
|skillname     |`string`    |否   |    |  技能名称 |
|value     | `integer`    |否   |    |  抵消威力值 |
|type     | `integer`    |否   |    |  计算方式(0按点数计算,1按百分比计算) |
```lua
    setmagicdefpower(play,"雷电术",500,0)
```

### 根据技能id获取技能名字
`getskillname`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|skillid     | `integer`    |否   |    |  技能id |
|result     |`string`    |否   |    |  技能名称 |

### 根据技能名字获取技能id
`getskillindex`

|参数|类型|空|默认|注释|
|:----    |:-------    |:--- |---|------      |
|skillname     |`string`    |否   |    |  技能名称 |
|result     | `integer`    |否   |    |  技能id |

### 改变技能特效

`setmagicskillefft`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**

| 参数      | 类型      | 空   | 默认 | 注释                                                    |
| :-------- | :-------- | :--- | :--- | :------------------------------------------------------ |
| play      | `object`  | 否   |      | 玩家对象                                                |
| skillName | `string`  | 否   |      | 技能名称                                                |
| effectID  | `integer` | 否   |      | 特效id,=0为关闭<br />(cfg_skill_present.xls表id)          |
| effectID2 | `integer` | 否   |      | 持续性ID(魔法盾BUFF表id/火墙/群体雷电术/其他的技能无效) |
```lua
    setmagicskillefft(actor,"雷电术", 33)
```

------------

## 获取玩家对象

### 根据玩家名
`getplayerbyname`

| 参数   | 类型     | 空   | 默认 | 注释     |
| :----- | :------- | :--- | :--- | :------- |
| name   | `string` | 否   |      | 玩家名字 |
| result | `object` | 否   |      | 玩家对象 |

### 根据玩家唯一ID
`getplayerbyid`

| 参数   | 类型     | 空   | 默认 | 注释       |
| :----- | :------- | :--- | :--- | :--------- |
| id     | `string` | 否   |      | 玩家唯一id |
| result | `object` | 否   |      | 玩家对象   |

------------

### 完美封号系统
`setranklevelname`

| 参数      | 类型     | 空   | 默认 | 注释                     |
| :-------- | :------- | :--- | :--- | :----------------------- |
| play      | `object` | 否   |      | 玩家对象                 |
| levelname | `string` | 否   |      | 称号文本，和名字一起显示 |
```lua
--显示在名字上方
setranklevelname(actor,"%s\\[击杀xx人]")

--显示在名字后方
setranklevelname(actor,"%s[击杀xx人]")
```

## 攻击模式

### 修改攻击模式
`changeattackmode`

| 参数       | 类型      | 空   | 默认 | 注释                                                                                                                                     |
| :--------- | :-------- | :--- | :--- | :--------------------------------------------------------------------------------------------------------------------------------------- |
| play       | `object`  | 否   |      | 玩家对象                                                                                                                                 |
| attackmode | `integer` | 否   |      | 攻击模式：<br />0-全体攻击<br />1-和平攻击<br />2-夫妻攻击<br />3-师徒攻击<br />4-编组攻击<br />5-行会攻击<br />6-红名攻击<br />7-国家攻击<br />8-阵营攻击 |

### 强制修改攻击模式
`setattackmode`

| 参数       | 类型      | 空   | 默认 | 注释                            |
| :--------- | :-------- | :--- | :--- | :------------------------------ |
| play       | `object`  | 否   |      | 玩家对象                        |
| attackmode | `integer` | 否   |      | 攻击模式<br />-1-提前结束强制状态 |
| time       | `integer` | 否   |      | 强制切换时间时间                |

### 获取当前攻击模式
`getattackmode`

| 参数   | 类型      | 空   | 默认 | 注释                                                                                                                                     |
| :----- | :-------- | :--- | :--- | :--------------------------------------------------------------------------------------------------------------------------------------- |
| play   | `object`  | 否   |      | 玩家对象                                                                                                                                 |
| result | `integer` | 否   |      | 攻击模式：<br />0-全体攻击<br />1-和平攻击<br />2-夫妻攻击<br />3-师徒攻击<br />4-编组攻击<br />5-行会攻击<br />6-红名攻击<br />7-国家攻击<br />8-阵营攻击 |

## 仓库

### 打开仓库面板

`openstorage`

| 参数     | 类型      | 空   | 默认                | 注释                         |
| :------- | :-------- | :--- | :------------------ | :--------------------------- |
| play     | `object`  | 否   |                     | 玩家对象                     |
| isOpenUI | `integer` | 是   | 引擎64_24.05.23新增 | 0/nil=打开UI<br />1=只下发数据 |

### 新解锁仓库格子

&gt; 最大支持240格 ,cfg_game_data.xls表 字段：warehouse_max_num 设置最大总仓库格子数

`changestorage`

| 参数   | 类型      | 空   | 默认 | 注释           |
| :----- | :-------- | :--- | :--- | :------------- |
| play   | `object`  | 否   |      | 玩家对象       |
| nCount | `integer` | 否   |      | 新解锁的格子数 |

### 获取仓库剩余格子数
`getsblank`

| 参数   | 类型      | 空   | 默认 | 注释           |
| :----- | :-------- | :--- | :--- | :------------- |
| play   | `object`  | 否   |      | 玩家对象       |
| result | `integer` | 否   |      | 仓库剩余格子数 |

### 获取玩家仓库最大格子数
`getssize`

| 参数   | 类型      | 空   | 默认 | 注释           |
| :----- | :-------- | :--- | :--- | :------------- |
| play   | `object`  | 否   |      | 玩家对象       |
| result | `integer` | 否   |      | 仓库最大格子数 |

------------

### 获取所有玩家对象列表(遍历玩家列表)

`getplayerlst`

| 参数    | 类型      | 空   | 默认                | 注释                                           |
| :------ | :-------- | :--- | :------------------ | :--------------------------------------------- |
| offline | `integer` | 是   | 引擎64_24.05.23新增 | 是否剔除离线挂机玩家<br />0/nil=不剔除<br />1=剔除 |

```lua
    local player_list = getplayerlst(0)
    for i, player  in ipairs(player_list or {}) do
        release_print("在线玩家",i,getbaseinfo(player,1),"角色是否离线挂机:",getbaseinfo(player,61))
    end
```

------------

### 获取玩家GM权限值
`getgmlevel`

| 参数   | 类型      | 空   | 默认 | 注释     |
| :----- | :-------- | :--- | :--- | :------- |
| play   | `object`  | 否   |      | 玩家对象 |
| result | `integer` | 否   |      | GM权限值 |

### 设置玩家GM权限值
`setgmlevel`

| 参数    | 类型      | 空   | 默认 | 注释     |
| :------ | :-------- | :--- | :--- | :------- |
| play    | `object`  | 否   |      | 玩家对象 |
| gmlevel | `integer` | 否   |      | GM权限值 |

------------

### 复活
`realive`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |

### 人物强制掉线(踢人下线)
`kick`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |

------------

### 延时跳转
`delaygoto`

| 参数 | 类型      | 空   | 默认 | 注释                                          |
| :--- | :-------- | :--- | :--- | :-------------------------------------------- |
| play | `object`  | 否   |      | 玩家对象                                      |
| time | `integer` | 否   |      | 时间(毫秒)                                    |
| func | `string`  | 否   |      | 触发函数                                      |
| del  | `integer` | 否   |      | 换地图是否删除此延时(0或为空时=不删除 1=删除) |

```lua
    delaygoto(actor,1000,"test_jump,ceshi,44",0)

    --QFunction-0.lua
    function test_jump(actor,...)
        release_print(getbaseinfo(actor,1),...)
    end
```

### 删除延迟

`cleardelaygoto`

| 参数 | 类型     | 空   | 默认                | 注释                                 |
| :--- | :------- | :--- | :------------------ | :----------------------------------- |
| play | `object` | 否   |                     | 玩家对象                             |
| func | `string` | 否   | 引擎64_23.08.30新增 | 需要删除的延时函数<br />不填为清除全部 |
```lua
delaygoto(actor,1000,"test_jump1",0)
cleardelaygoto(actor,"test_jump1")

delaygoto(actor,1000,"test_jump2,1,2,3",0)
cleardelaygoto(actor,"test_jump2,1,2,3")
```

### 添加系统延时回调

`grobaldelaygoto`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.05.23新增接口&lt;/font&gt;**

| 参数     | 类型      | 空   | 默认 | 注释       |
| :------- | :-------- | :--- | :--- | :--------- |
| time     | `integer` | 否   |      | 时间(毫秒) |
| funcName | `string`  | 否   |      | 触发函数   |

### 删除系统延时回调

`grobalcleardelaygoto`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.05.23新增接口&lt;/font&gt;**

| 参数     | 类型     | 空   | 默认 | 注释                                                                       |
| :------- | :------- | :--- | :--- | :------------------------------------------------------------------------- |
| funcName | `string` | 是   |      | 需要删除的延时函数<br />不填为清除全部                                       |
| value    | `string` | 是   | 0    | 是否忽视标签参数<br />0=不忽视,要完整填写添加时的参数<br />1=忽视,只判断函数名 |
```lua
    grobaldelaygoto(1000,"grobal_jump,a,b,c")

    grobalcleardelaygoto("grobal_jump,a,b,c",0)
    grobalcleardelaygoto("grobal_jump",1)
```

### 延时消息跳转
`delaymsggoto`

| 参数 | 类型      | 空   | 默认 | 注释       |
| :--- | :-------- | :--- | :--- | :--------- |
| play | `object`  | 否   |      | 玩家对象   |
| time | `integer` | 否   |      | 时间(毫秒) |
| func | `string`  | 否   |      | 触发函数   |
通过消息机制实现延时跳转，允许触发函数内嵌跳转，实现多次跳转，需要传递参数，将参数与函数名使用“,”连接。
本延时跳转不支持删除。
```lua
    delaymsggoto(actor, 2000, "@test_jump,ceshi,55")

    --QFunction-0.lua
    function test_jump(actor,...)
        release_print(getbaseinfo(actor,1),...)
    end
```

------------

### 增加附加伤害效果
`rangeharm`

| 参数       | 类型      | 空   | 默认               | 注释                                                                                                                                                                                                                                                       |
| :--------- | :-------- | :--- | :----------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| play       | `object`  | 否   |                    | 玩家对象                                                                                                                                                                                                                                                   |
| targetX    | `integer` | 否   |                    | X坐标                                                                                                                                                                                                                                                      |
| targetY    | `integer` | 否   |                    | Y坐标                                                                                                                                                                                                                                                      |
| range      | `integer` | 否   |                    | 影响范围                                                                                                                                                                                                                                                   |
| power      | `integer` | 否   |                    | 攻击力                                                                                                                                                                                                                                                     |
| addtype    | `integer` | 否   |                    | 附加类型：<br />0.无,1.击退,2.冻结,<br />3.麻痹,4.吸血,5.吸蓝,<br />6.真实伤害数值,7.蛛网效果,8.红毒,<br />9.绿毒,10.定身,11.防禁锢,<br />12.最大hp百分比真实伤害,<br />13.当前hp百分比真实伤害                                                                        |
| addvalue   | `integer` | 否   |                    | 附加属性值：<br />1.击退距离;2.冻结时间;<br />3.麻痹时间;4.吸血值;<br />5.吸蓝值;6.真实伤害值;<br />7.蛛网时间;8;红毒时间;<br />9.绿毒时间;<br />10.定身时间(定身时间单位是毫秒);<br />11.防禁锢时间(秒);<br />12.最大hp百分比真实伤害的值;<br />13.当前hp百分比真实伤害的值 |
| checkstate | `integer` | 否   |                    | 是否检查防冻结/麻痹/石化/冰冻/蛛网/红毒/绿毒属性<br />0=直接设置状态;1=检查后设置状态)                                                                                                                                                                       |
| targettype | `integer` | 否   |                    | 目标类型(0或空=所有目标;1=仅人物;2=仅怪物)                                                                                                                                                                                                                 |
| effectid   | `integer` | 否   |                    | 目标身上播放的特效ID                                                                                                                                                                                                                                       |
| harmNum    | `integer` | 否   | 引擎64_23.0628新增 | 群体伤害目标个数                                                                                                                                                                                                                                           |

### 人物飘血飘字特效
`sendattackeff`

| 参数   | 类型      | 空   | 默认 | 注释                                                                                                                                                              |
| :----- | :-------- | :--- | :--- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| target | `object`  | 否   |      | 飘血飘字的主体，一般为受攻击者                                                                                                                                    |
| type   | `integer` | 否   |      | 显示类型<br /> 1- 伤害，<br />2- 暴击伤害，<br />4- 加HP，<br />5- 格挡，<br />8- 扣减HP和MP，<br />9- 伤害，<br />10-扣减MP，<br />11- 致命一击<br />对应cfg_damage_number表里的ID |
| damage | `integer` | 否   |      | 显示的点数                                                                                                                                                        |
| hitter | `object`  | 否   |      | 可看到飘血飘字的主体，一般为攻击者                                                                                                                                |

```lua
[[
    参数1[target]可以为玩家对象、怪物对象
    参数4[hitter]可以传入字符串“*”表示该飘血飘字特效为广播特效，即视野范围内玩家均可见
]]
sendattackeff(monobj,1,999,"*")
```

### 设定人物攻击飘血飘字类型
`setattackefftype`

| 参数 | 类型      | 空   | 默认 | 注释                                                                                                                                                              |
| :--- | :-------- | :--- | :--- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| play | `object`  | 否   |      | 玩家对象                                                                                                                                                          |
| type | `integer` | 否   |      | 显示类型<br /> 1- 伤害，<br />2- 暴击伤害，<br />4- 加HP，<br />5- 格挡，<br />8- 扣减HP和MP，<br />9- 伤害，<br />10-扣减MP，<br />11- 致命一击<br />对应cfg_damage_number表里的ID |

```
设定人物飘血飘字类型，传入参数为攻击者，当前攻击飘血时有效，一次设定后，即返回默认值
```

------------

### 采集挖矿等进度条操作

`showprogressbardlg`

| 参数    | 类型      | 空   | 默认 | 注释                                 |
| :------ | :-------- | :--- | :--- | :----------------------------------- |
| play    | `object`  | 否   |      | 玩家对象                             |
| time    | `integer` | 否   |      | 进度条时间，秒                       |
| succ    | `string`  | 否   |      | 成功后跳转的函数                     |
| msg     | `string`  | 否   |      | 提示消息                             |
| canstop | `integer` | 否   |      | 能否中断<br />0-不可中断<br />1-可以中断 |
| fail    | `string`  | 否   |      | 中断触发的函数                       |
```lua
showprogressbardlg(actor,5,"@func_1","进度条测试..", 1,"@func_2")

[[注:跳转函数不能附带参数]]
function func_1(actor)
    release_print("func_1",getbaseinfo(actor,1))
end

function func_2(actor)
    release_print("func_2",getbaseinfo(actor,1))
end
```

### 改变玩家速度
`changespeed`

| 参数  | 类型      | 空   | 默认 | 注释                                                                      |
| :---- | :-------- | :--- | :--- | :------------------------------------------------------------------------ |
| play  | `object`  | 否   |      | 玩家对象                                                                  |
| type  | `integer` | 否   |      | 速度类型：<br />1-移动速度<br />2-攻击速度<br />3-施法速度                      |
| level | `integer` | 否   |      | 速度等级 -10~10<br />0-原始速度，<br />-1时间间隔减少10%<br />+1时间间隔增加10% |

### 百分比修改速度

`changespeedex`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**

| 参数  | 类型      | 空   | 默认 | 注释                                               |
| :---- | :-------- | :--- | :--- | :------------------------------------------------- |
| play  | `object`  | 否   |      | 玩家对象                                           |
| model | `integer` | 否   |      | 计算方式<br />1=移动速度<br />2=攻击速度<br />3=魔法速度 |
| value | `integer` | 否   |      | 速度值<br />0=原速度(大于0=加速 -=减速)              |
| time  | `integer` | 否   |      | 有效时间秒<br />(为空=表示不限制时间,最大值65535)    |
```lua
    changespeedex(actor,1,50,65535)
```

### 设置玩家穿人穿怪
`throughhum`

| 参数    | 类型      | 空   | 默认 | 注释                                         |
| :------ | :-------- | :--- | :--- | :------------------------------------------- |
| play    | `object`  | 否   |      | 玩家对象                                     |
| type    | `integer` | 否   |      | 模式：0-恢复默认；1-穿人；2-穿怪；3-穿人穿怪 |
| time    | `integer` | 否   |      | 时间(秒)                                     |
| objtype | `integer` | 否   |      | 对象 ：0-玩家；1-宝宝                        |

### 设置当前攻击目标
`settargetcert`

| 参数   | 类型     | 空   | 默认 | 注释                         |
| :----- | :------- | :--- | :--- | :--------------------------- |
| Hiter  | `object` | 否   |      | 攻击者<br />(玩家/英雄/怪物)   |
| Target | `object` | 否   |      | 被攻击者<br />(玩家/英雄/怪物) |
```
    将Hiter当前的攻击目标设定为Target
    注意：玩家实际攻击目标由客户端锁定，以修改当前玩家攻击目标为目的会失效。
```

### 判断对象是否可被攻击
`ispropertarget`

| 参数   | 类型      | 空   | 默认 | 注释                                          |
| :----- | :-------- | :--- | :--- | :-------------------------------------------- |
| Hiter  | `object`  | 否   |      | 攻击对象<br />(玩家/英雄/怪物)                  |
| Target | `object`  | 否   |      | 被攻击对象<br />(玩家/英雄/怪物)                |
| Result | `boolean` | 否   |      | 返回值<br />true:可以被攻击<br />false:不可被攻击 |

### 增加气泡
`addbutshow`

| 参数 | 类型      | 空   | 默认 | 注释                     |
| :--- | :-------- | :--- | :--- | :----------------------- |
| play | `object`  | 否   |      | 玩家对象                 |
| ID   | `integer` | 否   |      | ID                       |
| name | `string`  | 否   |      | 显示名称                 |
| fun  | `fun`     | 否   |      | 函数名(多参数用逗号分割) |
```lua
addbutshow(actor,1,"测试气泡","@testjump,参数1,参数2,参数3")

function testjump(actor,...)
    release_print(...)
end

```
### 删除气泡
`delbutshow`

| 参数 | 类型      | 空   | 默认 | 注释     |
| :--- | :-------- | :--- | :--- | :------- |
| play | `object`  | 否   |      | 玩家对象 |
| ID   | `integer` | 否   |      | ID       |

### 获取对面人物的名字
`getoppositeobj`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |
```lua
    local otherPlayer = getoppositeobj(actor)
    release_print("对面玩家",getbaseinfo(otherPlayer,1))
```

### 调用游戏面板

`openhyperlink`

| 参数    | 类型      | 空   | 默认                | 注释                                                                                                      |
| :------ | :-------- | :--- | :------------------ | :-------------------------------------------------------------------------------------------------------- |
| play    | `object`  | 否   |                     | 玩家对象                                                                                                  |
| nId     | `integer` | 否   |                     | 面板ID                                                                                                    |
| nState  | `integer` | 否   |                     | 0=打开<br />1=打开面板重复点按钮不会关闭,除非主动点关闭按钮(一般做任务配合新手引导用到)<br />2=关闭当前面板ID |
| rankWnd | `integer` | 否   | 引擎64_23.08.30新增 | 面板ID(新排行榜用)                                                                                        |
| isHero  | `integer` | 否   | 引擎64_23.08.30新增 | 0/nil=玩家<br />1=英雄(新排行榜用)                                                                          |

*跳转面板ID参考如下: *
```
        Equip               = 1,            -- 角色-装备
        State               = 2,            -- 角色-状态
        Attri               = 3,            -- 角色-属性
        Skill               = 4,            -- 角色-技能
        Title               = 5,            -- 角色-装备
        BestRing            = 6,            -- 角色-首饰盒
        Bag                 = 7,            -- 背包
        Stall               = 8,            -- 摆摊
        StoreHot            = 9,            -- 商城-热销
        StoreBeauty         = 10,           -- 商城-装饰
        StoreEngine         = 11,           -- 商城-功能
        StoreFestival       = 12,           -- 商城-节日
        GuildMain           = 13,           -- 行会-主界面
        GuildMember         = 14,           -- 行会成员列表
        GuildList           = 15,           -- 行会列表
        Mail                = 16,           -- 邮件
        Team                = 17,           -- 组队
        NearPlayer          = 18,           -- 附近玩家

        Setting             = 23,           -- 设置
        MiniMap             = 24,           -- 小地图
        SkillSetting        = 25,           -- 技能设置
        StoreRecharge       = 26,           -- 充值
        Auction             = 27,           -- 拍卖行
        Friend              = 28,           -- 好友
        ExitToRole          = 29,           -- 小退
        GuildCreate         = 30,           -- 行会创建
        Guild               = 31,           -- 智能行会界面
        Rank                = 32,           -- 排行榜
        Trade               = 33,           -- 面对面交易 请求
        ForceExitToRole     = 34,           -- 强制小退
        TradingBank         = 35,           -- 交易行
        GuideEnter          = 36,           -- 引导进入
        SuperEquip          = 37,           -- 角色-神装
        HeroEquip           = 41,           -- 英雄-装备
        HeroState           = 42,           -- 英雄-状态
        HeroAttri           = 43,           -- 英雄-属性
        HeroSkill           = 44,           -- 英雄-技能
        HeroTitle           = 45,           -- 英雄-称号
        HeroBestRing        = 46,           -- 英雄-首饰盒
        HeroBag             = 47,           -- 英雄-背包
        HeroSuperEquip      = 48,           -- 英雄-神装
        ReinAttrPoint       = 51,           -- 转生属性点
        Chat                = 52,           -- 聊天
        PCPrivate           = 53,           -- PC 私聊记录页

        MagicJointAttack    = 99,           -- 释放合击

        AssistChange        = 110,          -- 主界面-任务栏
        Box996              = 111,          -- 盒子称号
        MainMiniMapChange   = 112,          -- 小地图伸缩
        PCResolution        = 113,          -- PC 分辨率设置
        ChatExtendEmoj      = 114,          -- 角色-表情
        ChatExtendBag       = 115,          -- 聊天小框-背包
        MainNear            = 116,          -- 主界面-附近列表
        CallPay             = 117,          -- 调用-支付

        SettingBasic        = 300,          -- 基础设置
        SettingWindowRange  = 301,          -- 视距
        SettingFight        = 302,          -- 战斗
        SettingProtect      = 303,          -- 保护
        SettingAuto         = 304,          -- 挂机
        SettingHelp         = 305,          -- 帮助

        KeFu                = 310,          -- 调用客服界面
        Compound            = 2201,         -- 合成
```

### 开启自动挂机
`startautoattack`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |

### 停止自动挂机
`stopautoattack`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |

------------

### 离线挂机

`offlineplay`

&gt; 使用离线挂机功能，一定要在玩家退出游戏时候关闭所有定时器！
&gt; 本地环境使用离线挂机接口,重新登录时会出现无法登录情况,线上环境不会出现!

| 参数 | 类型      | 空   | 默认 | 注释           |
| :--- | :-------- | :--- | :--- | :------------- |
| play | `object`  | 否   |      | 玩家对象       |
| time | `integer` | 否   |      | 离线时间（分） |

### 剔除离线挂机角色

`tdummy`

| 参数  | 类型     | 空   | 默认 | 注释                                          |
| :---- | :------- | :--- | :--- | :-------------------------------------------- |
| mapID | `string` | 否   |      | 地图号, <br />“\*”表示全部地图                  |
| level | `string` | 否   |      | 剔除等级<br />低于此等级均剔除<br /> “\*”表示所有 |
| count | `string` | 否   |      | 最大剔除玩家数<br /> “\*”表示所有               |

### 获取玩家好友列表
`getfriendnamelist`

| 参数   | 类型     | 空   | 默认 | 注释           |
| :----- | :------- | :--- | :--- | :------------- |
| play   | `object` | 否   |      | 玩家对象       |
| result | `table`  | 否   |      | 好友的名字列表 |
```lua
    local list = getfriendnamelist(actor)
    for key, value in pairs(list or {}) do
        release_print(key,value)
    end
```

---

### 人物转生控制

`renewlevel`

| 参数   | 类型      | 空   | 默认 | 注释                                                                                 |
| :----- | :-------- | :--- | :--- | :----------------------------------------------------------------------------------- |
| play   | `object`  | 否   |      | 玩家对象                                                                             |
| rlevel | `integer` | 否   |      | 转生次数<br />一次转多少级(数值范围为1-255)                                            |
| level  | `integer` | 否   |      | 转生后等级<br />代表转生后人物的等级，0为不改变人物当前等级                            |
| num    | `integer` | 否   |      | 分配点数<br />转生后可以得到的点数，此点数可能按比例换成人物属性点(数值范围 1 - 20000) |

### 调整人物转生属性点

`bonuspoint`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**

| 参数  | 类型      | 空   | 默认 | 注释         |
| :---- | :-------- | :--- | :--- | :----------- |
| play  | `object`  | 否   |      | 玩家对象     |
| sFlag | `string`  | 否   |      | 操作符(=,+)  |
| value | `integer` | 否   |      | 点数(0-1000) |

### 获取人物转生属性点

`getbonuspoint`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**

| 参数   | 类型      | 空   | 默认 | 注释     |
| :----- | :-------- | :--- | :--- | :------- |
| play   | `object`  | 否   |      | 玩家对象 |
| result | `integer` | 否   |      | 属性点数 |

### 复位属性点数

`restbonuspoint`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.05.23新增接口&lt;/font&gt;**

| 参数  | 类型     | 空   | 默认 | 注释     |
| :---- | :------- | :--- | :--- | :------- |
| actor | `object` | 否   |      | 玩家对象 |

---

### 获取玩家pk等级
`getpklevel`

| 参数   | 类型      | 空   | 默认 | 注释                                      |
| :----- | :-------- | :--- | :--- | :---------------------------------------- |
| play   | `object`  | 否   |      | 玩家对象                                  |
| result | `integer` | 否   |      | pk等级<br />0.白名;1.黄名;2.红名;<br />3.灰名 |

------------

### 给按钮增加红点

`reddot`

| 参数          | 类型      | 空   | 默认 | 注释                                             |
| :------------ | :-------- | :--- | :--- | :----------------------------------------------- |
| play          | `object`  | 否   |      | 玩家对象                                         |
| win_id        | `integer` | 否   |      | 窗口ID                                           |
| btn_id        | `integer` | 否   |      | 按钮ID/任务栏填任务ID                            |
| x             | `integer` | 否   |      | X坐标                                            |
| y             | `integer` | 否   |      | Y坐标                                            |
| type          | `integer` | 否   |      | 红点模式<br />0=图片<br />1=特效                     |
| path/effectID | `integer` | 否   |      | 红点模式=0(填图片路径)<br />红点模式=1(填特效编号) |

```lua
reddot(actor, 104, 7, 15, 15, 1, 5055)
```

### 给按钮删除红点

`reddel`

| 参数   | 类型      | 空   | 默认 | 注释                  |
| :----- | :-------- | :--- | :--- | :-------------------- |
| play   | `object`  | 否   |      | 玩家对象              |
| win_id | `integer` | 否   |      | 窗口ID                |
| btn_id | `integer` | 否   |      | 按钮ID/任务栏填任务ID |

```lua
reddel(actor, 104, 7)
```

------------

### 拾取道具飞入背包按钮动作

`setpickitemtobag`

| 参数   | 类型      | 空   | 默认 | 注释     |
| :----- | :-------- | :--- | :--- | :------- |
| play   | `object`  | 否   |      | 玩家对象 |
| win_id | `integer` | 否   |      | 窗口ID   |
| btn_id | `integer` | 否   |      | 按钮ID   |

```lua
setpickitemtobag(actor,104,7)
```

------------

### 吸怪功能

`monmove`

| 参数     | 类型      | 空   | 默认 | 注释                                                                       |
| :------- | :-------- | :--- | :--- | :------------------------------------------------------------------------- |
| play     | `object`  | 否   |      | 玩家对象                                                                   |
| max      | `integer` | 否   |      | 最大范围                                                                   |
| min      | `integer` | 否   |      | 最小范围                                                                   |
| monLevel | `integer` | 否   |      | 怪物等级<br />=0则嘲讽/吸引所以级别怪物                                      |
| type     | `integer` | 否   |      | 0=不嘲讽玩家<br /> 1=嘲讽玩家                                                |
| isMove   | `integer` | 否   |      | 0=怪物漂移到人物边<br />1=怪物瞬移到目前人物坐标<br />2=怪物瞬移到目前人物面前 |
| unLimit  | `integer` | 否   |      | 0=无限制<br />1=怪物/人物攻击目标不归属自己的不可被吸                        |

```lua
monmove(actor,10, 2, 0, 0, 2, 0)
```

------------

### 人物显示一个放大的虚影

`showphantom`

| 参数    | 类型      | 空   | 默认 | 注释          |
| :------ | :-------- | :--- | :--- | :------------ |
| play    | `object`  | 否   |      | 玩家对象      |
| opacity | `integer` | 否   |      | 透明度(0~255) |
| time    | `integer` | 否   |      | 显示时间(秒)  |

```lua
showphantom(actor,100,3)
```

------------

### 绑定背包满触发

`bindevent`

| 参数         | 类型      | 空   | 默认 | 注释                       |
| :----------- | :-------- | :--- | :--- | :------------------------- |
| play         | `object`  | 否   |      | 玩家对象                   |
| bindingType  | `object`  | 否   |      | 绑定类型(1：背包满通知)    |
| isOpen       | `integer` | 否   |      | 是否开启(0：关闭，1：开启) |
| callbackFunc | `string`  | 否   |      | 回调函数(QF)               |

```lua
bindevent(actor,1,1,"@on_bag_full_lua")

--QFunction-0.lua
function on_bag_full_lua(actor,...)
end
```

------------

### 获取角色所有属性

`attrtab`

| 参数   | 类型     | 空   | 默认 | 注释       |
| :----- | :------- | :--- | :--- | :--------- |
| play   | `object` | 否   |      | 玩家对象   |
| result | `table`  | 否   |      | 所有属性值 |
```lua
    local attr = attrtab(actor)
    for key, value in pairs(attr or {}) do
        release_print("attr",key,value)
    end
```

------------

## 骑马相关

### 是否在骑马

`checkonhorse`

| 参数   | 类型     | 空   | 默认 | 注释        |
| :----- | :------- | :--- | :--- | :---------- |
| play   | `object` | 否   |      | 玩家对象    |
| result | `bool`   | 否   |      | true:在骑马 |

### 上马

`ridehorse`

| 参数        | 类型      | 空   | 默认 | 注释                               |
| :---------- | :-------- | :--- | :--- | :--------------------------------- |
| play        | `object`  | 否   |      | 玩家对象                           |
| HorseAppr   | `integer` | 否   |      | 坐骑外观                           |
| HorseEff    | `integer` | 否   |      | 坐骑特效外观                       |
| HorseFature | `integer` | 否   |      | 人物骑马外观                       |
| Type        | `integer` | 否   |      | 坐骑类型  0=单人   1=双人   2=连体 |

### 下马

`dismounthorse`

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |

------------

### 添加足迹特效

`setmoveeff `

| 参数     | 类型      | 空   | 默认 | 注释                                     |
| :------- | :-------- | :--- | :--- | :--------------------------------------- |
| play     | `object`  | 否   |      | 玩家对象                                 |
| effectID | `integer` | 否   |      | 特效id                                   |
| modle    | `integer` | 否   |      | 播放模式<br />0/nil=两步播放<br />1=单步播放 |
```lua
    setmoveeff(actor,17,1)
```

------------

### 给视野内玩家发送自定义广播消息

`setotherparams`

| 参数     | 类型      | 空   | 默认 | 注释        |
| :------- | :-------- | :--- | :--- | :---------- |
| play     | `object`  | 否   |      | 玩家对象    |
| varIdx   | `integer` | 否   |      | 属性id(1~5) |
| varValue | `integer` | 否   |      | 属性值      |
```lua
    [[服务端]]
    setotherparams(actor,1,3)
    -- setotherparams(actor,2,256)
    setotherparams(actor,2,414)

    [[客户端]]
    SL:RegisterLUAEvent(LUA_EVENT_ACTOR_GMDATA_UPDATE, "ACTOR_GM_DATA", function (tab)
        SL:dump(tab,"自定义数据改变")
        SL:dump(SL:GetMetaValue("ACTOR_GM_DATA",tab.id),"获取actor的GM自定义数据")
    end)
    [[足迹示例]]
    local function moveEvent(data)
        local actorID = data and data.id
        if actorID then
            local posX = SL:GetMetaValue("ACTOR_POSITION_X", actorID)
            local posY = SL:GetMetaValue("ACTOR_POSITION_Y", actorID)
            local dir = SL:GetMetaValue("ACTOR_DIR", actorID)
            local effectModel = SL:GetMetaValue("ACTOR_GM_DATA", actorID)[1]
            local effectID = SL:GetMetaValue("ACTOR_GM_DATA", actorID)[2]
            if effectID ~= 0 and posX and posY then
                local actBegin = data.act
                if actBegin == 1 or actBegin == 6 or actBegin == 17 then
                    local eff = GUI:Effect_Create(GUI:Attach_SceneB(), string.format("foot_effect%s_%s%s", actorID, posX, posY), posX, posY, effectModel, effectID, 0,0 , dir, 0.8)
                    GUI:setScale(eff, 0.3)
                    if eff then
                        GUI:Effect_addOnCompleteEvent(eff, function()
                            GUI:removeFromParent(eff)
                        end)
                    end
                end
            end
        end
    end
    SL:RegisterLUAEvent(LUA_EVENT_PLAYER_ACTION_BEGIN, "GUIUtil", moveEvent)
    SL:RegisterLUAEvent(LUA_EVENT_NET_PLAYER_ACTION_BEGIN, "GUIUtil", moveEvent)
```

------------

### 收摊

`stopmyshop`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.10.24新增接口&lt;/font&gt;**

| 参数   | 类型     | 空   | 默认 | 注释     |
| :----- | :------- | :--- | :--- | :------- |
| player | `object` | 否   |      | 玩家对象 |

------------

### 骰子功能

`playdice`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.10.24新增接口&lt;/font&gt;**

| 参数     | 类型      | 空   | 默认 | 注释                                   |
| :------- | :-------- | :--- | :--- | :------------------------------------- |
| player   | `object`  | 否   |      | 玩家对象                               |
| num      | `integer` | 否   |      | 动画数量<br />比如3就是会出现3个骰子转动 |
| funcName | `string`  | 否   |      | 动画结束触发                           |
```lua
    [[骰子的显示顺序和点数 对应 私人变量 D0 D1 D2 D3 D4 D5]]
    setplaydef(actor, "D0",1)
    setplaydef(actor, "D1",2)
    setplaydef(actor, "D2",3)
    setplaydef(actor, "D3",4)
    setplaydef(actor, "D4",5)
    setplaydef(actor, "D5",6)
    playdice(actor,1,"@test_jump,传参")

    -- QFunction-0.lua
    function test_jump(actor,...)
        release_print("test_jump,qf",getbaseinfo(actor,1),...)
    end
```

------------

### 开启宝箱

`opendragonbox`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.03.14新增接口&lt;/font&gt;**

| 参数   | 类型      | 空   | 默认 | 注释                                |
| :----- | :-------- | :--- | :--- | :---------------------------------- |
| actor  | `string`  | 否   |      | 玩家对象                            |
| boxidx | `integer` | 否   |      | 宝箱ID                              |
| num    | `integer` | 否   |      | 次数(不读数据表次数,只认这里的次数) |

------------

### 立即推送前端变量

`sendredvartoclient`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_23.12.07新增接口&lt;/font&gt;**

| 参数 | 类型     | 空   | 默认 | 注释     |
| :--- | :------- | :--- | :--- | :------- |
| play | `object` | 否   |      | 玩家对象 |

------------

### 设置人物照亮范围（光照）

`setcandlevalue`

&gt; **&lt;font color="#808080" style="font-size: 13px;"&gt;引擎64_24.05.23新增接口&lt;/font&gt;**

| 参数  | 类型      | 空   | 默认 | 注释                                |
| :---- | :-------- | :--- | :--- | :---------------------------------- |
| actor | `object`  | 否   |      | 玩家对象                            |
| value | `integer` | 否   |      | 人物照亮范围值<br />-1=读装备的光照值 |

```
    注:黑夜模式需在`M2-假人设置-光照系统-是否免蜡`中开启
```